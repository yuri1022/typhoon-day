"use strict";(self.webpackChunktyphoon=self.webpackChunktyphoon||[]).push([[6743,2945,4920],{15011:(e,t,i)=>{i.d(t,{EB:()=>h,Mj:()=>f,Ui:()=>y,w2:()=>p});var n=i(91967),r=i(94643),l=i(39314);const s=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function o(e){return e instanceof n.A}function a(e){return e instanceof r.A?Object.keys(e.items):o(e)?(0,l.oY)(e).keys():e?Object.keys(e):[]}function u(e,t){return e instanceof r.A?e.items[t]:e[t]}function d(e){return e?e.declaredClass:null}function c(e,t){const i=e.diff;if(i&&"function"==typeof i)return i(e,t);const n=a(e),r=a(t);if(0===n.length&&0===r.length)return;if(!n.length||!r.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};const l=r.filter((e=>!n.includes(e))),f=n.filter((e=>!r.includes(e))),h=n.filter((i=>r.includes(i)&&u(e,i)!==u(t,i))).concat(l,f).sort(),p=d(e);if(p&&s.has(p)&&h.length)return{type:"complete",oldValue:e,newValue:t};let y;const v=o(e)&&o(t);for(const s of h){const n=u(e,s),r=u(t,s);let l;if((v||"function"!=typeof n&&"function"!=typeof r)&&n!==r&&(null!=n||null!=r)){var m;if(i&&i[s]&&"function"==typeof i[s])l=null===(m=i[s])||void 0===m?void 0:m.call(i,n,r);else if(n instanceof Date&&r instanceof Date){if(n.getTime()===r.getTime())continue;l={type:"complete",oldValue:n,newValue:r}}else l="object"==typeof n&&"object"==typeof r&&d(n)===d(r)?c(n,r):{type:"complete",oldValue:n,newValue:r};null!=l&&(null!=y?y.diff[s]=l:y={type:"partial",diff:{[s]:l}})}}return y}function f(e,t){return h(e,t)}function h(e,t){if(null==e)return!1;const i=t.split(".");let n=e;for(const r of i){if("complete"===n.type)return!0;if("partial"!==n.type)return!1;{const e=n.diff[r];if(!e)return!1;n=e}}return!0}function p(e,t){if(!e)return!1;if("partial"===e.type){const i=Object.keys(e.diff);return 1===i.length&&i[0]===t}return!1}function y(e,t){if("function"!=typeof e&&"function"!=typeof t&&(null!=e||null!=t))return null==e||null==t||"object"==typeof e&&"object"==typeof t&&d(e)!==d(t)?{type:"complete",oldValue:e,newValue:t}:c(e,t)}},64920:(e,t,i)=>{i.d(t,{GB:()=>r,Qo:()=>s,Y4:()=>l});var n=i(24241);class r{}function l(e){return e instanceof n.bo?e===r.instance:"unknown"===(null===e||void 0===e?void 0:e.toString().toLowerCase())}function s(e){return l(e)?r.instance:e}r.instance=new n.oh("Etc/UTC")},76279:(e,t,i)=>{i.d(t,{$X:()=>S,Gy:()=>b,P5:()=>M,SW:()=>w,Tr:()=>_,VV:()=>n});i(19902);function n(e){var t,i;return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance,1,1]:[1,1,1,1],translate:null!=e.extent?[e.extent.xmin,e.extent.ymax,null!==(t=e.extent.zmin)&&void 0!==t?t:0,null!==(i=e.extent.mmin)&&void 0!==i?i:0]:[0,0,0,0]}:null}function r(e){var t,i,n,r,l,s,o,a;if(function(e){return"lowerLeft"===e.originPosition&&4===e.scale.length&&4===e.translate.length}(e))return e;const{originPosition:u,scale:d,translate:c}=e,f=null!==(t=d[0])&&void 0!==t?t:1,h=null!==(i=d[1])&&void 0!==i?i:1;return{originPosition:"lowerLeft",scale:[f,"lowerLeft"===u?h:-h,null!==(n=d[2])&&void 0!==n?n:1,null!==(r=d[3])&&void 0!==r?r:1],translate:[null!==(l=c[0])&&void 0!==l?l:0,null!==(s=c[1])&&void 0!==s?s:0,null!==(o=c[2])&&void 0!==o?o:0,null!==(a=c[3])&&void 0!==a?a:0]}}function l(e,t){let{scale:i,translate:n}=e;return Math.round((t-n[0])/i[0])}function s(e,t){let{scale:i,translate:n}=e;return Math.round((t-n[1])/i[1])}function o(e,t){let{scale:i,translate:n}=e;return Math.round(((null!==t&&void 0!==t?t:0)-n[2])/i[2])}function a(e,t){let{scale:i,translate:n}=e;return t?Math.round((t-n[3])/i[3]):0}function u(e,t){let{scale:i,translate:n}=e;return t*i[0]+n[0]}function d(e,t){let{scale:i,translate:n}=e;return t*i[1]+n[1]}function c(e,t){let{scale:i,translate:n}=e;return(null!==t&&void 0!==t?t:0)*i[2]+n[2]}function f(e,t){let{scale:i,translate:n}=e;return t?t*i[3]+n[3]:0}function h(e,t){return e&&t?m:e&&!t?y:!e&&t?v:p}const p=(e,t)=>{const i=new Array(t.length);if(!t.length)return i;const n=t[0];let r=u(e,n[0]),l=d(e,n[1]);i[0]=[r,l];const{scale:s,originPosition:o}=e,a=s[0],c="lowerLeft"===o?s[1]:-s[1];for(let u=1;u<t.length;u++){const[e,n]=t[u];r+=a*e,l+=c*n,i[u]=[r,l]}return i},y=(e,t)=>{const i=new Array(t.length);if(!t.length)return i;const n=t[0];let r=u(e,n[0]),l=d(e,n[1]);i[0]=[r,l,c(e,n[2])];const{scale:s,originPosition:o}=e,a=s[0],f="lowerLeft"===o?s[1]:-s[1];for(let u=1;u<t.length;u++){const[n,s,o]=t[u];r+=a*n,l+=f*s,i[u]=[r,l,c(e,o)]}return i},v=(e,t)=>{const i=new Array(t.length);if(!t.length)return i;const n=t[0];let r=u(e,n[0]),l=d(e,n[1]);i[0]=[r,l,f(e,n[2])];const{scale:s,originPosition:o}=e,a=s[0],c="lowerLeft"===o?s[1]:-s[1];for(let u=1;u<t.length;u++){const[n,s,o]=t[u];r+=a*n,l+=c*s,i[u]=[r,l,f(e,o)]}return i},m=(e,t)=>{const i=new Array(t.length);if(!t.length)return i;const n=t[0];let r=u(e,n[0]),l=d(e,n[1]);i[0]=[r,l,c(e,n[2]),f(e,n[3])];const{scale:s,originPosition:o}=e,a=s[0],h="lowerLeft"===o?s[1]:-s[1];for(let u=1;u<t.length;u++){const[n,s,o,d]=t[u];r+=a*n,l+=h*s,i[u]=[r,l,c(e,o),f(e,d)]}return i};function g(e,t,i){const n=new Array(i.length);for(let r=0;r<i.length;r++)n[r]=t(e,i[r]);return n}function b(e,t,i){const n=r(e);return t.x=l(n,i.x),t.y=s(n,i.y),null!=i.z&&(t.z=o(n,i.z)),null!=i.m&&(t.m=a(n,i.m)),t}function w(e,t,i){var n,l;let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null!==(n=null===i||void 0===i?void 0:i.hasZ)&&void 0!==n&&n,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null!==(l=null===i||void 0===i?void 0:i.hasM)&&void 0!==l&&l;if(null!=i){const n=r(e);t.points=h(s,o)(n,i.points),t.hasZ=s,t.hasM=o}return t}function _(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null!=(null===i||void 0===i?void 0:i.z),l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null!=(null===i||void 0===i?void 0:i.m);if(null==i)return t;const s=r(e);return t.x=u(s,i.x),t.y=d(s,i.y),n&&(t.z=c(s,i.z)),l&&(t.m=f(s,i.m)),t}function S(e,t,i){var n,l;let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null!==(n=null===i||void 0===i?void 0:i.hasZ)&&void 0!==n&&n,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null!==(l=null===i||void 0===i?void 0:i.hasM)&&void 0!==l&&l;if(null!=i){const n=r(e);t.rings=g(n,h(s,o),i.rings),t.hasZ=s,t.hasM=o}return t}function M(e,t,i){var n,l;let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null!==(n=null===i||void 0===i?void 0:i.hasZ)&&void 0!==n&&n,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null!==(l=null===i||void 0===i?void 0:i.hasM)&&void 0!==l&&l;if(null!=i){const n=r(e);t.paths=g(n,h(s,o),i.paths),t.hasZ=s,t.hasM=o}return t}},41324:(e,t,i)=>{i.r(t),i.d(t,{default:()=>k});var n,r=i(35143),l=(i(35238),i(94643)),s=i(73763),o=i(77717),a=i(50346),u=i(68134),d=i(90534),c=i(46053),f=(i(81806),i(76460),i(47249),i(28379)),h=i(85842),p=i(17707),y=i(13312),v=i(25515),m=i(65624),g=i(11270),b=i(94729),w=i(21617),_=i(5682),S=i(95363),M=i(54099),F=i(42553),I=i(49304),P=i(88685),Z=i(40565),A=i(69834),E=i(76797);let L=n=class extends(M.A.EventedMixin((0,F.Te)(I.A))){constructor(){super(...arguments),this.description=null,this.fullExtent=null,this.id=null,this.networkLink=null,this.parent=null,this.sublayers=null,this.title=null,this.sourceJSON=null,this.layer=null,this.addHandles([(0,u.on)((()=>this.sublayers),"after-add",(e=>{let{item:t}=e;t.parent=this,t.layer=this.layer}),u.OH),(0,u.on)((()=>this.sublayers),"after-remove",(e=>{let{item:t}=e;t.layer=t.parent=null}),u.OH),(0,u.wB)((()=>this.sublayers),((e,t)=>{if(t)for(const i of t)i.layer=i.parent=null;if(e)for(const i of e)i.parent=this,i.layer=this.layer}),u.OH),(0,u.wB)((()=>this.layer),(e=>{if(this.sublayers)for(const t of this.sublayers)t.layer=e}),u.OH)])}initialize(){(0,u.C_)((()=>this.networkLink)).then((()=>(0,u.C_)((()=>!0===this.visible)))).then((()=>this.load()))}load(e){var t,i;if(!this.networkLink)return;if(this.networkLink.viewFormat)return;const r=null!=e?e.signal:null,s=this._fetchService(null!==(t=null===(i=this._get("networkLink"))||void 0===i?void 0:i.href)&&void 0!==t?t:"",r).then((e=>{var t;const i=(0,A.Qm)(e.sublayers);this.fullExtent=E.A.fromJSON(i),this.sourceJSON=e;const r=(0,Z.dp)(l.A.ofType(n),(0,A.Jy)(n,e));this.sublayers?this.sublayers.addMany(r):this.sublayers=r,null!==(t=this.layer)&&void 0!==t&&t.emit("sublayer-update"),this.layer&&this.layer.notifyChange("visibleSublayers")}));return this.addResolvingPromise(s),Promise.resolve(this)}get visible(){return this._get("visible")}set visible(e){this._get("visible")!==e&&(this._set("visible",e),this.layer&&this.layer.notifyChange("visibleSublayers"))}readVisible(e,t){return!!t.visibility}_fetchService(e,t){return(0,A.Ox)(e,this.layer.outSpatialReference,this.layer.refreshInterval,t).then((e=>(0,A._4)(e.data)))}};(0,r._)([(0,c.MZ)()],L.prototype,"description",void 0),(0,r._)([(0,c.MZ)({type:E.A})],L.prototype,"fullExtent",void 0),(0,r._)([(0,c.MZ)()],L.prototype,"id",void 0),(0,r._)([(0,c.MZ)({readOnly:!0,value:null})],L.prototype,"networkLink",void 0),(0,r._)([(0,c.MZ)({json:{write:{allowNull:!0}}})],L.prototype,"parent",void 0),(0,r._)([(0,c.MZ)({type:l.A.ofType(L),json:{write:{allowNull:!0}}})],L.prototype,"sublayers",void 0),(0,r._)([(0,c.MZ)({value:null,json:{read:{source:"name",reader:e=>(0,P._e)(e)}}})],L.prototype,"title",void 0),(0,r._)([(0,c.MZ)({value:!0})],L.prototype,"visible",null),(0,r._)([(0,f.w)("visible",["visibility"])],L.prototype,"readVisible",null),(0,r._)([(0,c.MZ)()],L.prototype,"sourceJSON",void 0),(0,r._)([(0,c.MZ)()],L.prototype,"layer",void 0),L=n=(0,r._)([(0,h.$)("esri.layers.support.KMLSublayer")],L);const x=L,T=["kml","xml"];let O=class extends((0,m.dM)((0,w.J)((0,_.j)((0,g.q)((0,b.A)((0,o.P)(v.A))))))){constructor(){super(...arguments),this._visibleFolders=[],this.allSublayers=new s.A({getCollections:()=>[this.sublayers],getChildrenFunction:e=>e.sublayers}),this.outSpatialReference=y.A.WGS84,this.path=null,this.legendEnabled=!1,this.operationalLayerType="KML",this.sublayers=null,this.type="kml",this.url=null}initialize(){this.addHandles([(0,u.wB)((()=>this.sublayers),((e,t)=>{t&&t.forEach((e=>{e.parent=null,e.layer=null})),e&&e.forEach((e=>{e.parent=this,e.layer=this}))}),u.OH),this.on("sublayer-update",(()=>this.notifyChange("fullExtent")))])}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}readSublayersFromItemOrWebMap(e,t){this._visibleFolders=t.visibleFolders}readSublayers(e,t,i){return(0,A.Jy)(x,t,i,this._visibleFolders)}writeSublayers(e,t){const i=[],n=e.toArray();for(;n.length;){const e=n[0];e.networkLink||(e.visible&&i.push(e.id),e.sublayers&&n.push(...e.sublayers.toArray())),n.shift()}t.visibleFolders=i}get title(){const e=this._get("title");return e&&"defaults"!==this.originOf("title")?e:this.url?(0,d.e7)(this.url,T)||"KML":e}set title(e){this._set("title",e)}get visibleSublayers(){const e=this.sublayers,t=[],i=e=>{e.visible&&(t.push(e),e.sublayers&&e.sublayers.forEach(i))};return e&&e.forEach(i),t}get fullExtent(){return this._recomputeFullExtent()}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["KML"],supportsData:!1},e).catch(a.QP).then((()=>this._fetchService(t)))),Promise.resolve(this)}destroy(){super.destroy(),this.allSublayers.destroy()}async _fetchService(e){const t=await Promise.resolve().then((()=>{var t;return this.resourceInfo?{ssl:!1,data:this.resourceInfo}:(0,A.Ox)(null!==(t=this.url)&&void 0!==t?t:"",this.outSpatialReference,this.refreshInterval,e)})),i=(0,A._4)(t.data);i&&this.read(i,{origin:"service"})}_recomputeFullExtent(){let e=null;null!=this.extent&&(e=this.extent.clone());const t=i=>{if(i.sublayers)for(const n of i.sublayers.items)t(n),n.visible&&n.fullExtent&&(null!=e?e.union(n.fullExtent):e=n.fullExtent.clone())};return t(this),e}};(0,r._)([(0,c.MZ)({readOnly:!0})],O.prototype,"allSublayers",void 0),(0,r._)([(0,c.MZ)({type:y.A})],O.prototype,"outSpatialReference",void 0),(0,r._)([(0,c.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],O.prototype,"path",void 0),(0,r._)([(0,c.MZ)({readOnly:!0,json:{read:!1,write:!1}})],O.prototype,"legendEnabled",void 0),(0,r._)([(0,c.MZ)({type:["show","hide","hide-children"]})],O.prototype,"listMode",void 0),(0,r._)([(0,c.MZ)({type:["KML"]})],O.prototype,"operationalLayerType",void 0),(0,r._)([(0,c.MZ)({})],O.prototype,"resourceInfo",void 0),(0,r._)([(0,c.MZ)({type:l.A.ofType(x),json:{write:{ignoreOrigin:!0}}})],O.prototype,"sublayers",void 0),(0,r._)([(0,f.w)(["web-map","portal-item"],"sublayers",["visibleFolders"])],O.prototype,"readSublayersFromItemOrWebMap",null),(0,r._)([(0,f.w)("service","sublayers",["sublayers"])],O.prototype,"readSublayers",null),(0,r._)([(0,p.K)("sublayers")],O.prototype,"writeSublayers",null),(0,r._)([(0,c.MZ)({readOnly:!0,json:{read:!1}})],O.prototype,"type",void 0),(0,r._)([(0,c.MZ)({json:{origins:{"web-map":{read:{source:"title"}}},write:{ignoreOrigin:!0}}})],O.prototype,"title",null),(0,r._)([(0,c.MZ)(S.OZ)],O.prototype,"url",void 0),(0,r._)([(0,c.MZ)({readOnly:!0})],O.prototype,"visibleSublayers",null),(0,r._)([(0,c.MZ)({type:E.A})],O.prototype,"extent",void 0),(0,r._)([(0,c.MZ)()],O.prototype,"fullExtent",null),O=(0,r._)([(0,h.$)("esri.layers.KMLLayer")],O);const k=O},44081:(e,t,i)=>{i.d(t,{LF:()=>o,M9:()=>a,zu:()=>u});var n=i(50076),r=i(48611),l=i(7847),s=i(58503);function o(e,t,i){try{return function(e){if(!e||0===e.length)return null;if(function(e){const t=e[0];return!!t&&"scale"in t}(e)){const t=[];for(const i of e)t.push({scale:i.scale,value:u(i.value)});return t}return u(e)}(e)}catch(r){var n;null===i||void 0===i||null===(n=i.messages)||void 0===n||n.push(r)}return null}function a(e,t,i,n){try{const n=function(e){const t=(0,l.q)(e);return t?(0,s.dw)(t)?t.map((e=>e.toJSON())):t.map((e=>{let{scale:t,effects:i}=e;return{scale:t,value:i.map((e=>e.toJSON()))}})):null}(e);(0,r.sM)(i,n,t)}catch(a){n.messages&&n.messages.push(a)}}function u(e){if(null===e||void 0===e||!e.length)return"";const t=[];for(const i of e){let e=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":e=[d(i,"amount")];break;case"blur":e=[d(i,"radius","pt")];break;case"hue-rotate":e=[d(i,"angle","deg")];break;case"drop-shadow":e=[d(i,"xoffset","pt"),d(i,"yoffset","pt"),d(i,"blurRadius","pt"),c(i,"color")];break;case"bloom":e=[d(i,"strength"),d(i,"radius","pt"),d(i,"threshold")]}const n="".concat(i.type,"(").concat(e.filter(Boolean).join(" "),")");(0,l.q)(n),t.push(n)}return t.join(" ")}function d(e,t,i){if(null==e[t])throw new n.A("effect:missing-parameter","Missing parameter '".concat(t,"' in ").concat(e.type," effect"),{effect:e});return i?e[t]+i:""+e[t]}function c(e,t){if(null==e[t])throw new n.A("effect:missing-parameter","Missing parameter '".concat(t,"' in ").concat(e.type," effect"),{effect:e});const i=e[t];return"rgba(".concat(i[0]||0,", ").concat(i[1]||0,", ").concat(i[2]||0,", ").concat(i[3]/255||0,")")}},65624:(e,t,i)=>{i.d(t,{LF:()=>u,dM:()=>d,sU:()=>o});var n=i(35143),r=i(46053),l=(i(81806),i(76460),i(47249),i(85842)),s=i(44081);const o={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}},a={read:{reader:s.LF},write:{allowNull:!0,writer:s.M9}},u={json:{read:!1,write:!1,origins:{"web-map":a,"portal-item":a}}},d=e=>{let t=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return(0,n._)([(0,r.MZ)(o)],t.prototype,"blendMode",void 0),(0,n._)([(0,r.MZ)(u)],t.prototype,"effect",void 0),t=(0,n._)([(0,l.$)("esri.layers.mixins.BlendLayer")],t),t}},94729:(e,t,i)=>{i.d(t,{A:()=>S});var n=i(35143),r=i(86560),l=i(55171),s=i(3825),o=i(98773),a=i(50076),u=i(76460),d=i(30726),c=i(50346),f=i(90534),h=i(46053),p=(i(81806),i(47249),i(28379)),y=i(85842),v=i(17707),m=i(31933),g=i(65308),b=i(70652),w=i(38665),_=i(72945);const S=e=>{let t=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,d.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(e){e!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",e))}readPortalItem(e,t,i){if(t.itemId)return new b.default({id:t.itemId,portal:null===i||void 0===i?void 0:i.portal})}writePortalItem(e,t){(null===e||void 0===e?void 0:e.id)&&(t.itemId=e.id)}async loadFromPortal(e,t){var n;if(null!==(n=this.portalItem)&&void 0!==n&&n.id)try{const{load:n}=await Promise.all([i.e(2487),i.e(3814)]).then(i.bind(i,73814));return(0,c.Te)(t),await n({instance:this,supportedTypes:e.supportedTypes,validateItem:e.validateItem,supportsData:e.supportsData,layerModuleTypeMap:e.layerModuleTypeMap},t)}catch(r){throw(0,c.zf)(r)||u.A.getLogger(this).warn("Failed to load layer (".concat(this.title,", ").concat(this.id,") portal item (").concat(this.portalItem.id,")\n  ").concat(r)),r}}async finishLoadEditablePortalLayer(e){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(e).catch((e=>((0,c.QP)(e),!0))))}async setUserPrivileges(e,t){if(!r.A.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(t);if(this.url)try{const{features:{edit:i,fullEdit:n},content:{updateItem:r}}=await this._fetchUserPrivileges(e,t);this._set("userHasEditingPrivileges",i),this._set("userHasFullEditingPrivileges",n),this._set("userHasUpdateItemPrivileges",r)}catch(i){(0,c.QP)(i)}}async _fetchUserPrivileges(e,t){let i=this.portalItem;if(!e||!i||!i.loaded||i.sourceUrl)return this._fetchFallbackUserPrivileges(t);const n=e===i.id;if(n&&i.portal.user)return(0,_.It)(i);let r,s;if(n)r=i.portal.url;else try{r=await(0,m.wI)(this.url,t)}catch(d){(0,c.QP)(d)}if(!r||!(0,f.b8)(r,i.portal.url))return this._fetchFallbackUserPrivileges(t);try{const e=null!=t?t.signal:null;s=await(null===l.id||void 0===l.id?void 0:l.id.getCredential("".concat(r,"/sharing"),{prompt:!1,signal:e}))}catch(d){(0,c.QP)(d)}const o=!0,a=!1,u=!1;if(!s)return{features:{edit:o,fullEdit:a},content:{updateItem:u}};try{if(n?await i.reload():(i=new b.default({id:e,portal:{url:r}}),await i.load(t)),i.portal.user)return(0,_.It)(i)}catch(d){(0,c.QP)(d)}return{features:{edit:o,fullEdit:a},content:{updateItem:u}}}async _fetchFallbackUserPrivileges(e){let t=!0;try{t=await this._fetchUserHasEditingPrivileges(e)}catch(i){(0,c.QP)(i)}return{features:{edit:t,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(e){const t=this.url?null===l.id||void 0===l.id?void 0:l.id.findCredential(this.url):null;if(!t)return!0;const i=M.credential===t?M.user:await this._fetchEditingUser(e);return M.credential=t,M.user=i,null==(null===i||void 0===i?void 0:i.privileges)||i.privileges.includes("features:user:edit")}async _fetchEditingUser(e){var t,i;const n=null===(t=this.portalItem)||void 0===t||null===(t=t.portal)||void 0===t?void 0:t.user;if(n)return n;const r=null===l.id||void 0===l.id?void 0:l.id.findServerInfo(null!==(i=this.url)&&void 0!==i?i:"");if(null===r||void 0===r||!r.owningSystemUrl)return null;const a="".concat(r.owningSystemUrl,"/sharing/rest"),u=g.A.getDefault();if(u&&u.loaded&&(0,f.S8)(u.restUrl)===(0,f.S8)(a))return u.user;const d="".concat(a,"/community/self"),c=null!=e?e.signal:null,h=await(0,o.Ke)((0,s.A)(d,{authMode:"no-prompt",query:{f:"json"},signal:c}));return h.ok?w.A.fromJSON(h.value.data):null}read(e,t){t&&(t.layer=this),super.read(e,t)}write(e,t){var i;const n=null===t||void 0===t?void 0:t.portal,r=(null===(i=this.portalItem)||void 0===i?void 0:i.id)&&(this.portalItem.portal||g.A.getDefault());return n&&r&&!(0,f.ut)(r.restUrl,n.restUrl)?(t.messages&&t.messages.push(new a.A("layer:cross-portal","The layer '".concat(this.title," (").concat(this.id,")' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer"),{layer:this})),null):super.write(e,{...t,layer:this})}};return(0,n._)([(0,h.MZ)({type:b.default})],t.prototype,"portalItem",null),(0,n._)([(0,p.w)("web-document","portalItem",["itemId"])],t.prototype,"readPortalItem",null),(0,n._)([(0,v.K)("web-document","portalItem",{itemId:{type:String}})],t.prototype,"writePortalItem",null),(0,n._)([(0,h.MZ)({clonable:!1})],t.prototype,"resourceReferences",void 0),(0,n._)([(0,h.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasEditingPrivileges",void 0),(0,n._)([(0,h.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasFullEditingPrivileges",void 0),(0,n._)([(0,h.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasUpdateItemPrivileges",void 0),t=(0,n._)([(0,y.$)("esri.layers.mixins.PortalLayer")],t),t},M={credential:null,user:null}},21617:(e,t,i)=>{i.d(t,{J:()=>w});var n=i(35143),r=(i(81806),i(76460)),l=i(50346),s=i(46053),o=i(21403),a=(i(47249),i(85842)),u=i(80979),d=i(94643),c=(i(98773),i(50076),i(68452),i(49281));const f=new d.A,h=new WeakMap;function p(e){y(e)&&f.push(new WeakRef(e))}function y(e){return null!=e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e}function v(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:v(t,e%t):0}let m=0,g=0;function b(){const e=Date.now();let t=!1;for(const n of f){const r=n.deref();var i;if(r){if(r.refreshInterval)e-(null!==(i=h.get(r))&&void 0!==i?i:0)+5>=6e4*r.refreshInterval&&(h.set(r,e),r.refresh(e))}else t=!0}if(t)for(let n=f.length-1;n>=0;n--)f.at(n).deref()||f.removeAt(n)}(0,c.fm)((()=>{const e=Date.now();let t=0;for(const i of f){const n=i.deref();n&&(t=v(Math.round(6e4*n.refreshInterval),t),n.refreshInterval?h.get(n)||h.set(n,e):h.delete(n))}if(t!==g){if(g=t,clearInterval(m),0===g)return void(m=0);m=setInterval(b,g)}}));const w=e=>{let t=class extends e{constructor(){super(...arguments),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,l.sg)((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||p(this)}),(()=>{}))}destroy(){!function(e){const t=f.find((t=>t.deref()===e));t&&f.remove(t)}(this)}castRefreshInterval(e){return e>=.1?e:e<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();(0,l.QZ)(this._debounceHasDataChanged()).then((t=>{t&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:t})}),(e=>{r.A.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})}))}async hasDataChanged(){return!0}get test(){}};return(0,n._)([(0,s.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:u.K}}}}})],t.prototype,"refreshInterval",void 0),(0,n._)([(0,o.w)("refreshInterval")],t.prototype,"castRefreshInterval",null),(0,n._)([(0,s.MZ)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),(0,n._)([(0,s.MZ)({readOnly:!0})],t.prototype,"refreshParameters",null),t=(0,n._)([(0,a.$)("esri.layers.mixins.RefreshableLayer")],t),t}},5682:(e,t,i)=>{i.d(t,{j:()=>s});var n=i(35143),r=i(46053),l=(i(81806),i(76460),i(47249),i(85842));const s=e=>{let t=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const e={minScale:this.minScale,maxScale:this.maxScale},t=this.parent;t&&"effectiveScaleRange"in t&&function(e,t){e.minScale=e.minScale>0?t.minScale>0?Math.min(e.minScale,t.minScale):e.minScale:t.minScale,e.maxScale=e.maxScale>0?t.maxScale>0?Math.max(e.maxScale,t.maxScale):e.maxScale:t.maxScale}(e,t.effectiveScaleRange);const i=this._get("effectiveScaleRange");return i&&i.minScale===e.minScale&&i.maxScale===e.maxScale?i:e}};return(0,n._)([(0,r.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),(0,n._)([(0,r.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],t.prototype,"effectiveScaleRange",null),t=(0,n._)([(0,l.$)("esri.layers.mixins.ScaleRangeLayer")],t),t}},1900:(e,t,i)=>{i.d(t,{A:()=>f});var n=i(50076),r=i(42553),l=i(76460),s=i(87663),o=i(64920),a=i(53430),u=i(67478),d=i(24241);const c=new Map;class f{static fromJSON(e){return new f(e.fields,e.timeZoneByFieldName)}static fromLayer(e){var t;return new f(null!==(t=e.fields)&&void 0!==t?t:[],v(e))}static fromLayerJSON(e){var t;return new f(null!==(t=e.fields)&&void 0!==t?t:[],v(e))}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=t?new Map(t):null;const i=[];for(const r of this.fields){const e=null===r||void 0===r?void 0:r.name,t=p(e);if(e&&t){var n;const l=h(e);this._fieldsMap.set(e,r),this._fieldsMap.set(l,r),this._normalizedFieldsMap.set(t,r),i.push("".concat(l,":").concat(r.type,":").concat(null===(n=this._timeZoneByFieldName)||void 0===n?void 0:n.get(e))),(0,a.vE)(r)?(this.dateFields.push(r),this._dateFieldsSet.add(r)):(0,a.WA)(r)&&(this._numericFieldsSet.add(r),this.numericFields.push(r)),(0,a.te)(r)||(0,a.Xz)(r)||(r.editable=null==r.editable||!!r.editable,r.nullable=null==r.nullable||!!r.nullable)}}i.sort(),this.uid=i.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)(0,a.te)(e)||(0,a.Xz)(e)||e.nullable||void 0!==(0,a.lD)(e)||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===(null===e||void 0===e?void 0:e.uid)}has(e){return null!=this.get(e)}get(e){var t;if(!e)return;let i=this._fieldsMap.get(e);return i||(i=null!==(t=this._fieldsMap.get(h(e)))&&void 0!==t?t:this._normalizedFieldsMap.get(p(e)),i&&this._fieldsMap.set(e,i),i)}getTimeZone(e){const t=this.get(e&&"string"!=typeof e?e.name:e);return t?this._timeZoneByFieldName?this._timeZoneByFieldName.get(t.name):"date"===t.type||"esriFieldTypeDate"===t.type?(l.A.getLogger("esri.layers.support.FieldsIndex").error(new n.A("getTimeZone:no-timezone-information","no time zone information for field '".concat(t.name,"'"))),u.n$):y.has(t.type)?u.L5:null:null}getLuxonTimeZone(e){const t=this.getTimeZone(e);return t?t===u.L5?o.GB.instance:t===u.n$?d.mQ.utcInstance:(0,s.tE)(c,t,(()=>d.oh.create(t))):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return(0,a.OH)(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){var t,i;return null!==(t=null===(i=this.get(e))||void 0===i?void 0:i.name)&&void 0!==t?t:void 0}toJSON(){return{fields:this.fields.map((e=>(0,r.Wj)(e)?e.toJSON():e)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function h(e){return e.trim().toLowerCase()}function p(e){var t,i;return null!==(t=null===(i=(0,a.rS)(e))||void 0===i?void 0:i.toLowerCase())&&void 0!==t?t:""}const y=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function v(e){var t,i,n,r,l,s,o;const a=new Map;if(!e.fields)return a;const d=!0===e.datesInUnknownTimezone,{timeInfo:c,editFieldsInfo:f}=e,p=null!==(t=c?"startField"in c?c.startField:c.startTimeField:"")&&void 0!==t?t:"",v=null!==(i=c?"endField"in c?c.endField:c.endTimeField:"")&&void 0!==i?i:"",m=function(e){return"dateFieldsTimeZone"in e}(e)?null!==(n=e.dateFieldsTimeZone)&&void 0!==n?n:null:e.dateFieldsTimeReference?(0,u.ZS)(e.dateFieldsTimeReference):null,g=f?function(e){return"timeZone"in e}(f)?null!==(r=f.timeZone)&&void 0!==r?r:m:f.dateFieldsTimeReference?(0,u.ZS)(f.dateFieldsTimeReference):null!==m&&void 0!==m?m:u.n$:null,b=c?function(e){return"timeZone"in e}(c)?null!==(l=c.timeZone)&&void 0!==l?l:m:c.timeReference?(0,u.ZS)(c.timeReference):m:null,w=new Map([[h(null!==(s=null===f||void 0===f?void 0:f.creationDateField)&&void 0!==s?s:""),g],[h(null!==(o=null===f||void 0===f?void 0:f.editDateField)&&void 0!==o?o:""),g],[h(p),b],[h(v),b]]);for(const{name:S,type:M}of e.fields)if(y.has(M))a.set(S,u.L5);else if("date"!==M&&"esriFieldTypeDate"!==M)a.set(S,null);else if(d)a.set(S,u.L5);else{var _;const e=null!==(_=w.get(h(null!==S&&void 0!==S?S:"")))&&void 0!==_?_:m;a.set(S,e)}return a}},72945:(e,t,i)=>{i.d(t,{It:()=>f,LG:()=>s,OM:()=>u,Y:()=>o,bK:()=>a,mm:()=>c,sQ:()=>d});var n=i(26346),r=i(13312),l=i(45417);function s(e,t){if(!o(e,t)){const i=e.typeKeywords;i?i.push(t):e.typeKeywords=[t]}}function o(e,t){var i;return!(null===(i=e.typeKeywords)||void 0===i||!i.includes(t))}function a(e){return o(e,c.HOSTED_SERVICE)}function u(e,t){const i=e.typeKeywords;if(i){const e=i.indexOf(t);e>-1&&i.splice(e,1)}}async function d(e){const t=e.clone().normalize();let i;if(t.length>1)for(const n of t)i?n.width>i.width&&(i=n):i=n;else i=t[0];return async function(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return(0,l.ci)(e);const i=r.A.WGS84;return await(0,n.initializeProjection)(t,i),(0,n.project)(e,i)}(i)}const c={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function f(e){var t;const{portal:i,isOrgItem:n,itemControl:r}=e,l=null===(t=i.user)||void 0===t?void 0:t.privileges;let s=!l||l.includes("features:user:edit"),o=!!n&&!(null===l||void 0===l||!l.includes("features:user:fullEdit"));const a="update"===r||"admin"===r;return a?o=s=!0:o&&(s=!0),{features:{edit:s,fullEdit:o},content:{updateItem:a}}}}}]);
//# sourceMappingURL=6743.8f0566fd.chunk.js.map