"use strict";(self.webpackChunktyphoon=self.webpackChunktyphoon||[]).push([[576],{59784:(e,t,r)=>{r.d(t,{$:()=>y,IB:()=>s,N2:()=>x,RH:()=>b,Ws:()=>_,ZD:()=>g});var i=r(69539);r(43047),r(55855);function s(e){return"r"in e&&"g"in e&&"b"in e}function n(e){return"h"in e&&"s"in e&&"v"in e}function o(e){return"l"in e&&"a"in e&&"b"in e}function a(e){return"l"in e&&"c"in e&&"h"in e}const l=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],c=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function u(e,t){const r=[];let i,s;if(e[0].length!==t.length)throw new Error("dimensions do not match");const n=e.length,o=e[0].length;let a=0;for(i=0;i<n;i++){for(a=0,s=0;s<o;s++)a+=e[i][s]*t[s];r.push(a)}return r}function h(e){const t=[e.r/255,e.g/255,e.b/255].map((e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4)),r=u(l,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function d(e){const t=u(c,[e.x/100,e.y/100,e.z/100]).map((e=>{const t=e<=.0031308?12.92*e:1.055*e**(1/2.4)-.055;return Math.min(1,Math.max(t,0))}));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function p(e){const t=[e.x/95.047,e.y/100,e.z/108.883].map((e=>e>(6/29)**3?e**(1/3):1/3*(29/6)**2*e+4/29));return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function f(e){const t=e.l,r=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map((e=>e>6/29?e**3:3*(6/29)**2*(e-4/29)));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function m(e){return function(e){const t=e.l,r=e.a,i=e.b,s=Math.sqrt(r*r+i*i);let n=Math.atan2(i,r);return n=n>0?n:n+2*Math.PI,{l:t,c:s,h:n}}(p(h(e)))}function v(e){return d(f(function(e){const t=e.l,r=e.c,i=e.h;return{l:t,a:r*Math.cos(i),b:r*Math.sin(i)}}(e)))}function y(e){return s(e)?e:a(e)?v(e):o(e)?function(e){return d(f(e))}(e):function(e){return"x"in e&&"y"in e&&"z"in e}(e)?d(e):n(e)?function(e){const t=(e.h+360)%360/60,r=e.s/100,i=e.v/100*255,s=i*r,n=s*(1-Math.abs(t%2-1));let o;switch(Math.floor(t)){case 0:o={r:s,g:n,b:0};break;case 1:o={r:n,g:s,b:0};break;case 2:o={r:0,g:s,b:n};break;case 3:o={r:0,g:n,b:s};break;case 4:o={r:n,g:0,b:s};break;case 5:case 6:o={r:s,g:0,b:n};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+i-s),o.g=Math.round(o.g+i-s),o.b=Math.round(o.b+i-s),o}(e):e}function x(e){return n(e)?e:function(e){const t=e.r,r=e.g,i=e.b,s=Math.max(t,r,i),n=s-Math.min(t,r,i);let o=s,a=0===n?0:s===t?(r-i)/n%6:s===r?(i-t)/n+2:(t-r)/n+4,l=0===n?0:n/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}(y(e))}function g(e){return o(e)?e:function(e){return p(h(e))}(y(e))}function b(e){return a(e)?e:m(y(e))}function M(e){let{r:t,g:r,b:s,a:n}=e;return n<1&&(t=Math.round(n*t+255*(1-n)),r=Math.round(n*r+255*(1-n)),s=Math.round(n*s+255*(1-n))),new i.A({r:t,g:r,b:s})}function _(e,t){const{r:r,g:i,b:s}=null!==t&&void 0!==t&&t.ignoreAlpha?e:M(e);return.2126*r+.7152*i+.0722*s}var k;!function(e){e[e.Low=160]="Low",e[e.High=225]="High"}(k||(k={}))},42436:(e,t,r)=>{r.d(t,{$:()=>m});var i=r(69539),s=r(59784),n=r(53084),o=r(98976),a=r(97763),l=r(50076),c=r(76460),u=r(76279);function h(e,t,r,i,s){if(null==e)return null;const n=e.referencesGeometry()&&s?p(t,i,s):t,o=e.repurposeFeature(n);try{return e.evaluate({...r,$feature:o},e.services)}catch(a){return c.A.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",a),null}}const d=new Map;function p(e,t,r){const{transform:i,hasZ:s,hasM:n}=r;d.has(t)||d.set(t,function(e){const t={};switch(e){case"esriGeometryPoint":return(e,r,i,s)=>(0,u.Tr)(r,t,e,i,s);case"esriGeometryPolygon":return(e,r,i,s)=>(0,u.$X)(r,t,e,i,s);case"esriGeometryPolyline":return(e,r,i,s)=>(0,u.P5)(r,t,e,i,s);case"esriGeometryMultipoint":return(e,r,i,s)=>(0,u.SW)(r,t,e,i,s);default:return c.A.getLogger("esri.views.2d.support.arcadeOnDemand").error(new l.A("mapview-arcade","Unable to handle geometryType: ".concat(e))),e=>e}}(t));const o=d.get(t)(e.geometry,i,s,n);return{...e,geometry:o}}const f=e=>{if(!e)return[0,0,0,0];const{r:t,g:r,b:i,a:s}=e;return[t,r,i,255*s]};class m{static findApplicableOverrides(e,t,r){if(e&&t){if(e.primitiveName){let i=!1;for(const t of r)if(t.primitiveName===e.primitiveName){i=!0;break}if(!i)for(const s of t)s.primitiveName===e.primitiveName&&r.push(s)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const i of e.effects)m.findApplicableOverrides(i,t,r);if(e.symbolLayers)for(const i of e.symbolLayers)m.findApplicableOverrides(i,t,r);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const i of e.effects)m.findApplicableOverrides(i,t,r);if(e.markerPlacement&&m.findApplicableOverrides(e.markerPlacement,t,r),"CIMVectorMarker"===e.type){if(e.markerGraphics)for(const i of e.markerGraphics)m.findApplicableOverrides(i,t,r),m.findApplicableOverrides(i.symbol,t,r)}else"CIMCharacterMarker"===e.type?m.findApplicableOverrides(e.symbol,t,r):"CIMHatchFill"===e.type?m.findApplicableOverrides(e.lineSymbol,t,r):"CIMPictureMarker"===e.type&&m.findApplicableOverrides(e.animatedSymbolProperties,t,r)}}}static findEffectOverrides(e,t){if(!e)return null;if("CIMGeometricEffectDashes"===e.type&&(0,a.K3)(e),!t||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const r=(0,a.rB)(e),i=e.primitiveName,s=[];for(const n of t)n.primitiveName===i&&s.push((0,a.rB)(n));return{type:"cim-effect-param",effect:r,overrides:(0,a.pk)(s)}}static async resolveSymbolOverrides(e,t,r,i,s,o,l){if(null===e||void 0===e||!e.symbol)return null;let{symbol:c,primitiveOverrides:u}=e;const h=!!u;if(!h&&!i)return c;c=(0,n.o8)(c),u=(0,n.o8)(u);let d=!0;if(t||(t={attributes:{}},d=!1),h){if(d||(u=u.filter((e=>{var t;return!(null!==(t=e.valueExpressionInfo)&&void 0!==t&&t.expression.includes("$feature"))}))),l||(u=u.filter((e=>{var t;return!(null!==(t=e.valueExpressionInfo)&&void 0!==t&&t.expression.includes("$view"))}))),u.length>0){const e={spatialReference:r,fields:(0,a.O2)(t.attributes),geometryType:s};await m.createRenderExpressions(u,e),m.evaluateOverrides(u,t,null!==s&&void 0!==s?s:"esriGeometryPoint",o,l)}m.applyOverrides(c,u)}return i&&m.applyDictionaryTextOverrides(c,t,i,null),c}static async createRenderExpressions(e,t){const r=[];for(const i of e){const e=i.valueExpressionInfo;if(!e||m._expressionToRenderExpression.has(e.expression))continue;const s=(0,o.Ad)(e.expression,t.spatialReference,t.fields);r.push(s),s.then((t=>m._expressionToRenderExpression.set(e.expression,t)))}r.length>0&&await Promise.all(r)}static evaluateOverrides(e,t,r,i,n){const o={$view:{scale:null===n||void 0===n?void 0:n.scale}};for(const a of e){a.value&&"object"==typeof a.value&&(0,s.IB)(a.value)&&("Color"===a.propertyName||"StrokeColor"===a.propertyName)&&(a.value=f(a.value));const e=a.valueExpressionInfo;if(!e)continue;const n=m._expressionToRenderExpression.get(e.expression);n&&(a.value=h(n,t,o,r,i))}}static applyDictionaryTextOverrides(e,t,r,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Normal";if(null!==e&&void 0!==e&&e.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const n=e.symbolLayers;if(!n)return;for(const o of n)o&&"CIMVectorMarker"===o.type&&m.applyDictionaryTextOverrides(o,t,r,i,"CIMTextSymbol"===e.type?e.textCase:s)}break;case"CIMVectorMarker":{const s=e.markerGraphics;if(!s)return;for(const e of s)e&&m.applyDictionaryTextOverrides(e,t,r,i)}break;case"CIMMarkerGraphic":{const n=e.textString;if(n&&n.includes("[")){const o=(0,a.gQ)(n,r);e.textString=(0,a.FM)(t,o,i,s)}}}}static applyOverrides(e,t,r,i){if(e.primitiveName)for(const s of t)if(s.primitiveName===e.primitiveName){const t=(0,a.YF)(s.propertyName);if(i&&i.push({cim:e,nocapPropertyName:t,value:e[t]}),r){let t=!1;for(const i of r)i.primitiveName===e.primitiveName&&(t=!0);t||r.push(s)}null!=s.value&&(e[t]=s.value)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const s of e.effects)m.applyOverrides(s,t,r,i);if(e.symbolLayers)for(const s of e.symbolLayers)m.applyOverrides(s,t,r,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const s of e.effects)m.applyOverrides(s,t,r,i);if("CIMVectorMarker"===e.type&&e.markerGraphics)for(const s of e.markerGraphics)m.applyOverrides(s,t,r,i),m.applyOverrides(s.symbol,t,r,i)}}static restoreOverrides(e){for(const t of e)t.cim[t.nocapPropertyName]=t.value}static buildOverrideKey(e){let t="";for(const r of e)void 0!==r.value&&(t+="".concat(r.primitiveName).concat(r.propertyName).concat(JSON.stringify(r.value)));return t}static toValue(e,t){if("DashTemplate"===e)return t.split(" ").map((e=>Number(e)));if("Color"===e){const e=new i.A(t).toRgba();return e[3]*=255,e}return t}}m._expressionToRenderExpression=new Map},16060:(e,t,r)=>{r.d(t,{LG:()=>d,mb:()=>f,yr:()=>p});var i=r(50346),s=r(63919),n=r(85827),o=r(59422),a=r(8794),l=r(96145),c=r(93345),u=r(98433),h=r(96673);function d(e){return e&&"render"in e}function p(e){const t=document.createElement("canvas");return t.width=e.width,t.height=e.height,e.render(t.getContext("2d")),t}class f extends a.q{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.blendFunction="standard",this._sourceWidth=0,this._sourceHeight=0,this._textureInvalidated=!1,this._texture=null,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.immutable=t,this.source=e,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null),null!=this._uploadStatus&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)}get isSourceScaled(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}get height(){return void 0!==this._height?this._height:this._sourceHeight}set height(e){this._height=e}get source(){return this._source}set source(e){null==e&&null==this._source||(this._source=e,this.invalidateTexture(),this.requestRender())}get width(){return void 0!==this._width?this._width:this._sourceWidth}set width(e){this._width=e}beforeRender(e){super.beforeRender(e),this.updateTexture(e)}async setSourceAsync(e,t){null!=this._uploadStatus&&this._uploadStatus.controller.abort();const r=new AbortController,s=(0,i.Tw)();return(0,i.NY)(t,(()=>r.abort())),(0,i.NY)(r,(e=>s.reject(e))),this._uploadStatus={controller:r,resolver:s},this.source=e,s.promise}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):this._source&&(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width))}updateTransitionProperties(e,t){e>=64&&(this.fadeTransitionEnabled=!1,this.inFadeTransition=!1),super.updateTransitionProperties(e,t)}setTransform(e){const t=(0,s.D_)(this.transforms.displayViewScreenMat3),[r,i]=e.toScreenNoRotation([0,0],[this.x,this.y]),n=this.resolution/this.pixelRatio/e.resolution,a=n*this.width,l=n*this.height,c=Math.PI*this.rotation/180;(0,s.Tl)(t,t,(0,o.fA)(r,i)),(0,s.Tl)(t,t,(0,o.fA)(a/2,l/2)),(0,s.e$)(t,t,-c),(0,s.Tl)(t,t,(0,o.fA)(-a/2,-l/2)),(0,s.Oe)(t,t,(0,o.fA)(a,l)),(0,s.lw)(this.transforms.displayViewScreenMat3,e.displayViewMat3,t)}setSamplingProfile(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))}bind(e,t){this._texture&&e.bindTexture(this._texture,t)}async updateTexture(e){let{context:t,painter:r}=e;if(!this._textureInvalidated)return;if(this._textureInvalidated=!1,this._texture||(this._texture=this._createTexture(t)),!this.source)return void this._texture.setData(null);this._texture.resize(this._sourceWidth,this._sourceHeight);const s=function(e){var t;return d(e)?e instanceof l.A?null===(t=e.getRenderedRasterPixels())||void 0===t?void 0:t.renderedRasterPixels:p(e):e}(this.source);try{if(null!=this._uploadStatus){const{controller:e,resolver:t}=this._uploadStatus,i={signal:e.signal},{width:n,height:o}=this,a=this._texture,l=r.textureUploadManager;await l.enqueueTextureUpdate({data:s,texture:a,width:n,height:o},i),t.resolve(),this._uploadStatus=null}else this._texture.setData(s);this.ready()}catch(n){(0,i.jH)(n)}}onDetach(){this.destroy()}_createTransforms(){return{displayViewScreenMat3:(0,n.vt)()}}_createTexture(e){const t=this.immutable,r=new h.R;return r.internalFormat=t?c.H0.RGBA8:c.Ab.RGBA,r.wrapMode=c.pF.CLAMP_TO_EDGE,r.isImmutable=t,r.width=this._sourceWidth,r.height=this._sourceHeight,new u.g(e,r)}}},96145:(e,t,r)=>{r.d(t,{A:()=>i});class i{constructor(e,t,r){this.pixelBlock=e,this.extent=t,this.originalPixelBlock=r}get width(){return null!=this.pixelBlock?this.pixelBlock.width:0}get height(){return null!=this.pixelBlock?this.pixelBlock.height:0}render(e){var t;const r=this.pixelBlock;if(null==r)return;const i=this.filter({extent:this.extent,pixelBlock:null!==(t=this.originalPixelBlock)&&void 0!==t?t:r});if(null==i.pixelBlock)return;i.pixelBlock.maskIsAlpha&&(i.pixelBlock.premultiplyAlpha=!0);const s=i.pixelBlock.getAsRGBA(),n=e.createImageData(i.pixelBlock.width,i.pixelBlock.height);n.data.set(s),e.putImageData(n,0,0)}getRenderedRasterPixels(){const e=this.filter({extent:this.extent,pixelBlock:this.pixelBlock});return null==e.pixelBlock?null:(e.pixelBlock.maskIsAlpha&&(e.pixelBlock.premultiplyAlpha=!0),{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)})}}},70822:(e,t,r)=>{r.d(t,{A:()=>c});var i=r(35143),s=(r(76460),r(81806),r(47249),r(50076),r(85842)),n=r(61551),o=r(8995),a=r(13692);let l=class extends o.f{get hasHighlight(){return this.children.some((e=>e.hasData))}renderChildren(e){this.attributeView.update(),e.drawPhase===n.S5.HIGHLIGHT&&this.children.some((e=>e.hasData))&&(super.renderChildren(e),e.context.setColorMask(!0,!0,!0,!0),(0,a.lB)(e,!0,(e=>{this._renderChildren(e,n.RI.All)})))}};l=(0,i._)([(0,s.$)("esri.views.2d.layers.graphics.HighlightGraphicContainer")],l);const c=l},2257:(e,t,r)=>{r.d(t,{D8:()=>n,TO:()=>s});var i=r(53430);async function s(e){var t,r;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.popupTemplate;if(null==s)return[];const n=await s.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:o}=s,{objectIdField:a,typeIdField:l,globalIdField:c,relationships:u}=e;if(n.includes("*"))return["*"];const h=o?(0,i.eX)(e):[],d=(0,i.DB)(e.fieldsIndex,[...n,...h]);return l&&d.push(l),d&&a&&null!==(t=e.fieldsIndex)&&void 0!==t&&t.has(a)&&!d.includes(a)&&d.push(a),d&&c&&null!==(r=e.fieldsIndex)&&void 0!==r&&r.has(c)&&!d.includes(c)&&d.push(c),u&&u.forEach((t=>{var r;const{keyField:i}=t;d&&i&&(null===(r=e.fieldsIndex)||void 0===r?void 0:r.has(i))&&!d.includes(i)&&d.push(i)})),d}function n(e,t){return e.popupTemplate?e.popupTemplate:null!=t&&t.defaultPopupTemplateEnabled&&null!=e.defaultPopupTemplate?e.defaultPopupTemplate:null}}}]);
//# sourceMappingURL=576.1a399fb1.chunk.js.map