"use strict";(self.webpackChunktyphoon=self.webpackChunktyphoon||[]).push([[9223],{59784:(e,t,r)=>{r.d(t,{$:()=>v,IB:()=>s,N2:()=>g,RH:()=>_,Ws:()=>M,ZD:()=>b});var i=r(69539);r(43047),r(55855);function s(e){return"r"in e&&"g"in e&&"b"in e}function n(e){return"h"in e&&"s"in e&&"v"in e}function o(e){return"l"in e&&"a"in e&&"b"in e}function a(e){return"l"in e&&"c"in e&&"h"in e}const l=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],c=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function h(e,t){const r=[];let i,s;if(e[0].length!==t.length)throw new Error("dimensions do not match");const n=e.length,o=e[0].length;let a=0;for(i=0;i<n;i++){for(a=0,s=0;s<o;s++)a+=e[i][s]*t[s];r.push(a)}return r}function u(e){const t=[e.r/255,e.g/255,e.b/255].map((e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4)),r=h(l,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function p(e){const t=h(c,[e.x/100,e.y/100,e.z/100]).map((e=>{const t=e<=.0031308?12.92*e:1.055*e**(1/2.4)-.055;return Math.min(1,Math.max(t,0))}));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function d(e){const t=[e.x/95.047,e.y/100,e.z/108.883].map((e=>e>(6/29)**3?e**(1/3):1/3*(29/6)**2*e+4/29));return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function f(e){const t=e.l,r=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map((e=>e>6/29?e**3:3*(6/29)**2*(e-4/29)));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function m(e){return function(e){const t=e.l,r=e.a,i=e.b,s=Math.sqrt(r*r+i*i);let n=Math.atan2(i,r);return n=n>0?n:n+2*Math.PI,{l:t,c:s,h:n}}(d(u(e)))}function y(e){return p(f(function(e){const t=e.l,r=e.c,i=e.h;return{l:t,a:r*Math.cos(i),b:r*Math.sin(i)}}(e)))}function v(e){return s(e)?e:a(e)?y(e):o(e)?function(e){return p(f(e))}(e):function(e){return"x"in e&&"y"in e&&"z"in e}(e)?p(e):n(e)?function(e){const t=(e.h+360)%360/60,r=e.s/100,i=e.v/100*255,s=i*r,n=s*(1-Math.abs(t%2-1));let o;switch(Math.floor(t)){case 0:o={r:s,g:n,b:0};break;case 1:o={r:n,g:s,b:0};break;case 2:o={r:0,g:s,b:n};break;case 3:o={r:0,g:n,b:s};break;case 4:o={r:n,g:0,b:s};break;case 5:case 6:o={r:s,g:0,b:n};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+i-s),o.g=Math.round(o.g+i-s),o.b=Math.round(o.b+i-s),o}(e):e}function g(e){return n(e)?e:function(e){const t=e.r,r=e.g,i=e.b,s=Math.max(t,r,i),n=s-Math.min(t,r,i);let o=s,a=0===n?0:s===t?(r-i)/n%6:s===r?(i-t)/n+2:(t-r)/n+4,l=0===n?0:n/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}(v(e))}function b(e){return o(e)?e:function(e){return d(u(e))}(v(e))}function _(e){return a(e)?e:m(v(e))}function x(e){let{r:t,g:r,b:s,a:n}=e;return n<1&&(t=Math.round(n*t+255*(1-n)),r=Math.round(n*r+255*(1-n)),s=Math.round(n*s+255*(1-n))),new i.A({r:t,g:r,b:s})}function M(e,t){const{r:r,g:i,b:s}=null!==t&&void 0!==t&&t.ignoreAlpha?e:x(e);return.2126*r+.7152*i+.0722*s}var w;!function(e){e[e.Low=160]="Low",e[e.High=225]="High"}(w||(w={}))},63733:(e,t,r)=>{r.d(t,{A:()=>d});var i=r(35143),s=r(46053),n=(r(81806),r(76460),r(47249),r(85842)),o=r(5364),a=r(25515),l=r(65624),c=r(5682),h=r(64519),u=r(731);let p=class extends((0,l.dM)((0,c.j)(a.A))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new h.Y,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,i._)([(0,s.MZ)({type:u.A})],p.prototype,"elevationInfo",void 0),(0,i._)([(0,s.MZ)((0,o.C)(h.Y,"graphics"))],p.prototype,"graphics",void 0),(0,i._)([(0,s.MZ)({type:["show","hide"]})],p.prototype,"listMode",void 0),(0,i._)([(0,s.MZ)()],p.prototype,"screenSizePerspectiveEnabled",void 0),(0,i._)([(0,s.MZ)({readOnly:!0})],p.prototype,"type",void 0),(0,i._)([(0,s.MZ)({constructOnly:!0})],p.prototype,"internal",void 0),p=(0,i._)([(0,n.$)("esri.layers.GraphicsLayer")],p);const d=p},44081:(e,t,r)=>{r.d(t,{LF:()=>a,M9:()=>l,zu:()=>c});var i=r(50076),s=r(48611),n=r(7847),o=r(58503);function a(e,t,r){try{return function(e){if(!e||0===e.length)return null;if(function(e){const t=e[0];return!!t&&"scale"in t}(e)){const t=[];for(const r of e)t.push({scale:r.scale,value:c(r.value)});return t}return c(e)}(e)}catch(s){var i;null===r||void 0===r||null===(i=r.messages)||void 0===i||i.push(s)}return null}function l(e,t,r,i){try{const i=function(e){const t=(0,n.q)(e);return t?(0,o.dw)(t)?t.map((e=>e.toJSON())):t.map((e=>{let{scale:t,effects:r}=e;return{scale:t,value:r.map((e=>e.toJSON()))}})):null}(e);(0,s.sM)(r,i,t)}catch(l){i.messages&&i.messages.push(l)}}function c(e){if(null===e||void 0===e||!e.length)return"";const t=[];for(const r of e){let e=[];switch(r.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":e=[h(r,"amount")];break;case"blur":e=[h(r,"radius","pt")];break;case"hue-rotate":e=[h(r,"angle","deg")];break;case"drop-shadow":e=[h(r,"xoffset","pt"),h(r,"yoffset","pt"),h(r,"blurRadius","pt"),u(r,"color")];break;case"bloom":e=[h(r,"strength"),h(r,"radius","pt"),h(r,"threshold")]}const i="".concat(r.type,"(").concat(e.filter(Boolean).join(" "),")");(0,n.q)(i),t.push(i)}return t.join(" ")}function h(e,t,r){if(null==e[t])throw new i.A("effect:missing-parameter","Missing parameter '".concat(t,"' in ").concat(e.type," effect"),{effect:e});return r?e[t]+r:""+e[t]}function u(e,t){if(null==e[t])throw new i.A("effect:missing-parameter","Missing parameter '".concat(t,"' in ").concat(e.type," effect"),{effect:e});const r=e[t];return"rgba(".concat(r[0]||0,", ").concat(r[1]||0,", ").concat(r[2]||0,", ").concat(r[3]/255||0,")")}},65624:(e,t,r)=>{r.d(t,{LF:()=>c,dM:()=>h,sU:()=>a});var i=r(35143),s=r(46053),n=(r(81806),r(76460),r(47249),r(85842)),o=r(44081);const a={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}},l={read:{reader:o.LF},write:{allowNull:!0,writer:o.M9}},c={json:{read:!1,write:!1,origins:{"web-map":l,"portal-item":l}}},h=e=>{let t=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return(0,i._)([(0,s.MZ)(a)],t.prototype,"blendMode",void 0),(0,i._)([(0,s.MZ)(c)],t.prototype,"effect",void 0),t=(0,i._)([(0,n.$)("esri.layers.mixins.BlendLayer")],t),t}},5682:(e,t,r)=>{r.d(t,{j:()=>o});var i=r(35143),s=r(46053),n=(r(81806),r(76460),r(47249),r(85842));const o=e=>{let t=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const e={minScale:this.minScale,maxScale:this.maxScale},t=this.parent;t&&"effectiveScaleRange"in t&&function(e,t){e.minScale=e.minScale>0?t.minScale>0?Math.min(e.minScale,t.minScale):e.minScale:t.minScale,e.maxScale=e.maxScale>0?t.maxScale>0?Math.max(e.maxScale,t.maxScale):e.maxScale:t.maxScale}(e,t.effectiveScaleRange);const r=this._get("effectiveScaleRange");return r&&r.minScale===e.minScale&&r.maxScale===e.maxScale?r:e}};return(0,i._)([(0,s.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),(0,i._)([(0,s.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),(0,i._)([(0,s.MZ)({readOnly:!0})],t.prototype,"effectiveScaleRange",null),t=(0,i._)([(0,n.$)("esri.layers.mixins.ScaleRangeLayer")],t),t}},90360:(e,t,r)=>{r.d(t,{A:()=>c});var i=r(35143),s=r(69098),n=r(42553),o=r(46053),a=(r(81806),r(76460),r(47249),r(85842));let l=class extends((0,s.O)(n.oY)){constructor(e){super(e),this.frameCenter=null,this.frameOutline=null,this.lineOfSight=null,this.sensorLocation=null,this.sensorTrail=null}};(0,i._)([(0,o.MZ)({type:Boolean})],l.prototype,"frameCenter",void 0),(0,i._)([(0,o.MZ)({type:Boolean})],l.prototype,"frameOutline",void 0),(0,i._)([(0,o.MZ)({type:Boolean})],l.prototype,"lineOfSight",void 0),(0,i._)([(0,o.MZ)({type:Boolean})],l.prototype,"sensorLocation",void 0),(0,i._)([(0,o.MZ)({type:Boolean})],l.prototype,"sensorTrail",void 0),l=(0,i._)([(0,a.$)("esri.layers.support.TelemetryDisplay")],l);const c=l},42436:(e,t,r)=>{r.d(t,{$:()=>m});var i=r(69539),s=r(59784),n=r(53084),o=r(98976),a=r(97763),l=r(50076),c=r(76460),h=r(76279);function u(e,t,r,i,s){if(null==e)return null;const n=e.referencesGeometry()&&s?d(t,i,s):t,o=e.repurposeFeature(n);try{return e.evaluate({...r,$feature:o},e.services)}catch(a){return c.A.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",a),null}}const p=new Map;function d(e,t,r){const{transform:i,hasZ:s,hasM:n}=r;p.has(t)||p.set(t,function(e){const t={};switch(e){case"esriGeometryPoint":return(e,r,i,s)=>(0,h.Tr)(r,t,e,i,s);case"esriGeometryPolygon":return(e,r,i,s)=>(0,h.$X)(r,t,e,i,s);case"esriGeometryPolyline":return(e,r,i,s)=>(0,h.P5)(r,t,e,i,s);case"esriGeometryMultipoint":return(e,r,i,s)=>(0,h.SW)(r,t,e,i,s);default:return c.A.getLogger("esri.views.2d.support.arcadeOnDemand").error(new l.A("mapview-arcade","Unable to handle geometryType: ".concat(e))),e=>e}}(t));const o=p.get(t)(e.geometry,i,s,n);return{...e,geometry:o}}const f=e=>{if(!e)return[0,0,0,0];const{r:t,g:r,b:i,a:s}=e;return[t,r,i,255*s]};class m{static findApplicableOverrides(e,t,r){if(e&&t){if(e.primitiveName){let i=!1;for(const t of r)if(t.primitiveName===e.primitiveName){i=!0;break}if(!i)for(const s of t)s.primitiveName===e.primitiveName&&r.push(s)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const i of e.effects)m.findApplicableOverrides(i,t,r);if(e.symbolLayers)for(const i of e.symbolLayers)m.findApplicableOverrides(i,t,r);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const i of e.effects)m.findApplicableOverrides(i,t,r);if(e.markerPlacement&&m.findApplicableOverrides(e.markerPlacement,t,r),"CIMVectorMarker"===e.type){if(e.markerGraphics)for(const i of e.markerGraphics)m.findApplicableOverrides(i,t,r),m.findApplicableOverrides(i.symbol,t,r)}else"CIMCharacterMarker"===e.type?m.findApplicableOverrides(e.symbol,t,r):"CIMHatchFill"===e.type?m.findApplicableOverrides(e.lineSymbol,t,r):"CIMPictureMarker"===e.type&&m.findApplicableOverrides(e.animatedSymbolProperties,t,r)}}}static findEffectOverrides(e,t){if(!e)return null;if("CIMGeometricEffectDashes"===e.type&&(0,a.K3)(e),!t||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const r=(0,a.rB)(e),i=e.primitiveName,s=[];for(const n of t)n.primitiveName===i&&s.push((0,a.rB)(n));return{type:"cim-effect-param",effect:r,overrides:(0,a.pk)(s)}}static async resolveSymbolOverrides(e,t,r,i,s,o,l){if(null===e||void 0===e||!e.symbol)return null;let{symbol:c,primitiveOverrides:h}=e;const u=!!h;if(!u&&!i)return c;c=(0,n.o8)(c),h=(0,n.o8)(h);let p=!0;if(t||(t={attributes:{}},p=!1),u){if(p||(h=h.filter((e=>{var t;return!(null!==(t=e.valueExpressionInfo)&&void 0!==t&&t.expression.includes("$feature"))}))),l||(h=h.filter((e=>{var t;return!(null!==(t=e.valueExpressionInfo)&&void 0!==t&&t.expression.includes("$view"))}))),h.length>0){const e={spatialReference:r,fields:(0,a.O2)(t.attributes),geometryType:s};await m.createRenderExpressions(h,e),m.evaluateOverrides(h,t,null!==s&&void 0!==s?s:"esriGeometryPoint",o,l)}m.applyOverrides(c,h)}return i&&m.applyDictionaryTextOverrides(c,t,i,null),c}static async createRenderExpressions(e,t){const r=[];for(const i of e){const e=i.valueExpressionInfo;if(!e||m._expressionToRenderExpression.has(e.expression))continue;const s=(0,o.Ad)(e.expression,t.spatialReference,t.fields);r.push(s),s.then((t=>m._expressionToRenderExpression.set(e.expression,t)))}r.length>0&&await Promise.all(r)}static evaluateOverrides(e,t,r,i,n){const o={$view:{scale:null===n||void 0===n?void 0:n.scale}};for(const a of e){a.value&&"object"==typeof a.value&&(0,s.IB)(a.value)&&("Color"===a.propertyName||"StrokeColor"===a.propertyName)&&(a.value=f(a.value));const e=a.valueExpressionInfo;if(!e)continue;const n=m._expressionToRenderExpression.get(e.expression);n&&(a.value=u(n,t,o,r,i))}}static applyDictionaryTextOverrides(e,t,r,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Normal";if(null!==e&&void 0!==e&&e.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const n=e.symbolLayers;if(!n)return;for(const o of n)o&&"CIMVectorMarker"===o.type&&m.applyDictionaryTextOverrides(o,t,r,i,"CIMTextSymbol"===e.type?e.textCase:s)}break;case"CIMVectorMarker":{const s=e.markerGraphics;if(!s)return;for(const e of s)e&&m.applyDictionaryTextOverrides(e,t,r,i)}break;case"CIMMarkerGraphic":{const n=e.textString;if(n&&n.includes("[")){const o=(0,a.gQ)(n,r);e.textString=(0,a.FM)(t,o,i,s)}}}}static applyOverrides(e,t,r,i){if(e.primitiveName)for(const s of t)if(s.primitiveName===e.primitiveName){const t=(0,a.YF)(s.propertyName);if(i&&i.push({cim:e,nocapPropertyName:t,value:e[t]}),r){let t=!1;for(const i of r)i.primitiveName===e.primitiveName&&(t=!0);t||r.push(s)}null!=s.value&&(e[t]=s.value)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const s of e.effects)m.applyOverrides(s,t,r,i);if(e.symbolLayers)for(const s of e.symbolLayers)m.applyOverrides(s,t,r,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const s of e.effects)m.applyOverrides(s,t,r,i);if("CIMVectorMarker"===e.type&&e.markerGraphics)for(const s of e.markerGraphics)m.applyOverrides(s,t,r,i),m.applyOverrides(s.symbol,t,r,i)}}static restoreOverrides(e){for(const t of e)t.cim[t.nocapPropertyName]=t.value}static buildOverrideKey(e){let t="";for(const r of e)void 0!==r.value&&(t+="".concat(r.primitiveName).concat(r.propertyName).concat(JSON.stringify(r.value)));return t}static toValue(e,t){if("DashTemplate"===e)return t.split(" ").map((e=>Number(e)));if("Color"===e){const e=new i.A(t).toRgba();return e[3]*=255,e}return t}}m._expressionToRenderExpression=new Map},731:(e,t,r)=>{r.d(t,{A:()=>_});var i,s=r(35143),n=r(45802),o=r(42553),a=r(30726),l=r(46053),c=(r(81806),r(76460),r(47249),r(28379)),h=r(85842),u=r(17707),p=r(53430);let d=i=class extends o.oY{constructor(e){super(e)}async collectRequiredFields(e,t){return(0,p.Dx)(e,t,this.expression)}clone(){return new i({expression:this.expression,title:this.title})}equals(e){return this.expression===e.expression&&this.title===e.title}};(0,s._)([(0,l.MZ)({type:String,json:{write:!0}})],d.prototype,"expression",void 0),(0,s._)([(0,l.MZ)({type:String,json:{write:!0}})],d.prototype,"title",void 0),d=i=(0,s._)([(0,h.$)("esri.symbols.support.FeatureExpressionInfo")],d);const f=d;var m,y=r(59097);const v=(0,n.O)()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),g=new n.J({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let b=m=class extends o.oY{constructor(e){super(e),this.offset=null}readFeatureExpressionInfo(e,t){return null!=e?e:t.featureExpression&&0===t.featureExpression.value?{expression:"0"}:void 0}writeFeatureExpressionInfo(e,t,r,i){t[r]=e.write({},i),"0"===e.expression&&(t.featureExpression={value:0})}get mode(){const{offset:e,featureExpressionInfo:t}=this;return this._isOverridden("mode")?this._get("mode"):null!=e||t?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,t){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,t):null}clone(){return new m({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&(0,a.CM)(this.featureExpressionInfo,e.featureExpressionInfo)}};(0,s._)([(0,l.MZ)({type:f,json:{write:!0}})],b.prototype,"featureExpressionInfo",void 0),(0,s._)([(0,c.w)("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],b.prototype,"readFeatureExpressionInfo",null),(0,s._)([(0,u.K)("featureExpressionInfo",{featureExpressionInfo:{type:f},"featureExpression.value":{type:[0]}})],b.prototype,"writeFeatureExpressionInfo",null),(0,s._)([(0,l.MZ)({type:v.apiValues,nonNullable:!0,json:{type:v.jsonValues,read:v.read,write:{writer:v.write,isRequired:!0}}})],b.prototype,"mode",null),(0,s._)([(0,l.MZ)({type:Number,json:{write:!0}})],b.prototype,"offset",void 0),(0,s._)([(0,l.MZ)({type:y.KQ,json:{type:String,read:g.read,write:g.write}})],b.prototype,"unit",null),b=m=(0,s._)([(0,h.$)("esri.symbols.support.ElevationInfo")],b);const _=b},59097:(e,t,r)=>{r.d(t,{Ao:()=>s,KQ:()=>n});var i=r(3454);function s(e){return 1/(i.j[e]||1)}const n=function(){const e=Object.keys(i.j);return e.sort(),e}()},43018:(e,t,r)=>{r.r(t),r.d(t,{default:()=>N});var i=r(35143),s=r(69539),n=r(39356),o=(r(95444),r(30726)),a=r(68134),l=r(46053),c=(r(81806),r(76460),r(47249),r(85842)),h=r(63733),u=r(90360),p=r(97466),d=(r(35238),r(79053)),f=r(88321),m=r(76931),y=r(72745),v=r(26346),g=r(8794),b=r(47266),_=r(76718),x=r(93345),M=r(98433),w=r(96673),C=r(36911),S=r(65215),O=r(19247);class A extends g.q{constructor(e){super(),this.element=e,this._handles=new f.A,this.isWrapAround=!1,this.perspectiveTransform=(0,y.vt)(),this.wrapAroundShift=0,this.clipGeometry=null,this._handles.add((0,a.z7)((()=>this.element),(()=>{const e=this.element;this.ready(),e&&this._handles.add((0,d.on)(e,"play",(()=>this.requestRender())))}),a.Vh))}getMesh(e){throw new Error("Method not implemented.")}destroy(){this._handles.destroy(),this.texture=(0,o.WD)(this.texture),this._vao&&(this._vao.dispose(),this._vao=null),this._vbo&&(this._vbo.dispose(),this._vbo=null),this.texture&&(this.texture.dispose(),this.texture=null)}get textureSize(){if(!this.texture)return[1,1];const e=this.texture.descriptor;return[e.width,e.height]}get dvsMat3(){return this.parent.dvsMat3}beforeRender(e){const t=this.element;if(null==t)return;const{context:r}=e,{videoWidth:i,videoHeight:s}=t;if(0!==i&&0!==s){if(this.texture)t.paused||this.texture.setData(t);else{const e=new w.R;e.wrapMode=x.pF.CLAMP_TO_EDGE,e.preMultiplyAlpha=!0,e.width=i,e.height=s,this.texture=new M.g(r,e,t)}t.paused||(this.texture.generateMipmap(),this.requestRender()),super.beforeRender(e)}}_createTransforms(){return null}updateDrawCoords(e,t,r,i){const s=this.element,n=this._getFrameInfo();if(!s||!n)return;this._initializeData(e,n,r);const{controlPoints:o,horizon:a}=n,l=Math.sqrt(o.length),c=l,{x:h,y:u}=e,p=this._vertices,d=o[0],f=o[l-1],m=o[(c-1)*l],y=o[(c-1)*l+l-1],g=(0,v.project)(a?a[0].mapPoint:d.mapPoint,r),_=(0,v.project)(a?a[1].mapPoint:f.mapPoint,r),x=(0,v.project)(m.mapPoint,r),M=(0,v.project)(y.mapPoint,r);this.clipGeometry=a?new b.A({geometry:S.A.fromJSON({rings:[[[x.x,x.y],[M.x,M.y],[_.x,_.y],[g.x,g.y],[x.x,x.y]]],spatialReference:r})}):null;for(let b=0;b<o.length;b++){const e=o[b],{sourcePoint:t,mapPoint:i}=e;if(null==t||null==i)continue;const s=(0,v.project)(i,r);p[2*b+0]=s.x-h,p[2*b+1]=s.y-u}let w=t;if(i){const e=Math.min(g.x,_.x,x.x,M.x),t=Math.max(g.x,_.x,x.x,M.x),{worldWidth:r,xBounds:s}=i,[n,o]=s;e<n&&t>n?w=r:t>o&&e<o&&(w=-r)}this.wrapAroundShift=w,this.isWrapAround=0!==w}getVAO(e,t,r){if(null==this._vertices)return null;const i=this._vertices;if(this._vao)this._vbo.setData(i);else{this._vbo=_.g.createVertex(e,x._U.DYNAMIC_DRAW,i);const s=_.g.createVertex(e,x._U.STATIC_DRAW,this._texCoords);this._ibo=_.g.createIndex(e,x._U.DYNAMIC_DRAW,this._indices),this._vao=new C.Z(e,r,t,{geometry:this._vbo,tex:s},this._ibo)}return this._vao}draw(e){e.drawElements(x.WR.TRIANGLE_STRIP,this._indices.length,e.gl.UNSIGNED_SHORT,0)}_initializeData(e,t,r){if(null!=this._vertices&&null!=this._indices)return;const{controlPoints:i}=t,s=Math.sqrt(i.length),n=s,o=new Float32Array(2*i.length),a=new Uint16Array(2*i.length);for(let h=0;h<i.length;h++){const t=i[h],{sourcePoint:s,mapPoint:n}=t;if(null==s||null==n)continue;const l=(0,v.project)(n,r);o[2*h+0]=l.x-e.x,o[2*h+1]=l.y-e.y,a[2*h+0]=s.x,a[2*h+1]=s.y}const l=new Uint16Array(n*s+(n-2)*(s+2));let c=0;for(let h=0;h<n;h++){for(let e=0;e<s;e++)l[c++]=h*s+e,l[c++]=(h+1)*s+e;h<n-2&&(l[c++]=(h+1)*s+(s-1),l[c++]=(h+1)*s)}this._vertices=o,this._texCoords=a,this._indices=l}_getFrameInfo(){if(!this.groundControlPoints)return null;const e=this._getFrameControlPoints(),t=this.frameHorizonPoints;let r=null;if(t){const e=t.startX,i=t.startY,s=t.endX,n=t.endY;r=[{sourcePoint:(0,m.tc)(e,i),mapPoint:new O.A(t.startLongitude,t.startLatitude)},{sourcePoint:(0,m.tc)(s,n),mapPoint:new O.A(t.endLongitude,t.endLatitude)}]}return{controlPoints:e,horizon:r}}_getFrameControlPoints(){const e=this.groundControlPoints,t=null===e||void 0===e?void 0:e.length;if(!t)return[];const r=new Array(t);for(let i=0;i<t;i++){const{x:t,y:s,lat:n,lon:o}=e[i];r[i]={sourcePoint:(0,m.tc)(t,-s),mapPoint:new O.A(o,n)}}return r}}var I=r(90104),E=r(31394),T=r(43321),P=r(91196),G=r(86875),k=r(7246),L=r(76940);const D=new s.A([255,127,0]);let R=class extends((0,I.e)(P.A)){constructor(){super(...arguments),this._graphicsLayer=new h.A,this._frameOutlineGraphic=new n.A({symbol:new G.A({outline:{type:"simple-line",color:D}})}),this._sensorTrailGraphic=new n.A({symbol:new k.A({color:D})}),this._lineOfSightGraphic=new n.A({symbol:new k.A({color:D})}),this._sensorLocationGraphic=new n.A({symbol:new L.A({color:D})}),this._frameCenterGraphic=new n.A({symbol:new L.A({color:D})}),this._overlayContainer=null,this.layer=null,this.symbolColor=D,this.visibleTelemetryElements=null}destroy(){this._graphicsLayer=(0,o.pR)(this._graphicsLayer)}initialize(){var e,t,r,i,s,n,o,l,c,h;this.addHandles((0,a.wB)((()=>this.symbolColor),(()=>{this._frameOutlineGraphic.symbol.outline.color=this.symbolColor,this._sensorTrailGraphic.symbol.color=this.symbolColor,this._lineOfSightGraphic.symbol.color=this.symbolColor,this._sensorLocationGraphic.symbol.color=this.symbolColor,this._frameCenterGraphic.symbol.color=this.symbolColor}),a.Vh)),this._graphicsLayer.graphics.addMany([this._frameOutlineGraphic,this._sensorTrailGraphic,this._lineOfSightGraphic,this._sensorLocationGraphic,this._frameCenterGraphic]),this.visibleTelemetryElements=new u.A({frameCenter:null===(e=null===(t=this.layer.telemetryDisplay)||void 0===t?void 0:t.frameCenter)||void 0===e||e,frameOutline:null===(r=null===(i=this.layer.telemetryDisplay)||void 0===i?void 0:i.frameOutline)||void 0===r||r,lineOfSight:null===(s=null===(n=this.layer.telemetryDisplay)||void 0===n?void 0:n.lineOfSight)||void 0===s||s,sensorLocation:null===(o=null===(l=this.layer.telemetryDisplay)||void 0===l?void 0:l.sensorLocation)||void 0===o||o,sensorTrail:null===(c=null===(h=this.layer.telemetryDisplay)||void 0===h?void 0:h.sensorTrail)||void 0===c||c})}attach(){this._overlayContainer=new p.A,this.container.addChild(this._overlayContainer),this._addOverlayMultipoint(),this.graphicsView=new T.A({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:this._graphicsLayer.graphics,container:new E.A(this.view.featuresTilingScheme)}),this.container.addChild(this.graphicsView.container),this.addAttachHandles(this._graphicsLayer.on("graphic-update",this.graphicsView.graphicUpdateHandler)),this.addAttachHandles([(0,a.wB)((()=>{var e,t,r,i,s;return[null===(e=this.layer.telemetryDisplay)||void 0===e?void 0:e.frameCenter,null===(t=this.layer.telemetryDisplay)||void 0===t?void 0:t.frameOutline,null===(r=this.layer.telemetryDisplay)||void 0===r?void 0:r.sensorLocation,null===(i=this.layer.telemetryDisplay)||void 0===i?void 0:i.sensorTrail,null===(s=this.layer.telemetryDisplay)||void 0===s?void 0:s.lineOfSight]}),(()=>this._updateVisibleTelemetryElements()),a.Vh),(0,a.wB)((()=>{var e,t,r,i,s;return[this.layer.telemetry,null===(e=this.visibleTelemetryElements)||void 0===e?void 0:e.frameCenter,null===(t=this.visibleTelemetryElements)||void 0===t?void 0:t.frameOutline,null===(r=this.visibleTelemetryElements)||void 0===r?void 0:r.sensorLocation,null===(i=this.visibleTelemetryElements)||void 0===i?void 0:i.sensorTrail,null===(s=this.visibleTelemetryElements)||void 0===s?void 0:s.lineOfSight]}),(()=>this._updateGraphicGeometries()),a.Vh)])}detach(){this._overlayContainer.removeAllChildren(),this.container.removeAllChildren(),this.graphicsView=(0,o.pR)(this.graphicsView)}supportsSpatialReference(e){return!0}moveEnd(){}viewChange(){this.graphicsView.viewChange()}update(e){this.graphicsView.processUpdate(e)}isUpdating(){return!this.graphicsView||this.graphicsView.updating}_updateVisibleTelemetryElements(){this.visibleTelemetryElements&&this.layer.telemetryDisplay&&(this.visibleTelemetryElements.frameCenter=this.layer.telemetryDisplay.frameCenter,this.visibleTelemetryElements.frameOutline=this.layer.telemetryDisplay.frameOutline,this.visibleTelemetryElements.lineOfSight=this.layer.telemetryDisplay.lineOfSight,this.visibleTelemetryElements.sensorLocation=this.layer.telemetryDisplay.sensorLocation,this.visibleTelemetryElements.sensorTrail=this.layer.telemetryDisplay.sensorTrail)}_updateGraphicGeometries(){const{telemetry:e}=this.layer,{visibleTelemetryElements:t}=this;e&&t&&(t.frameOutline&&e.frameOutline?this._frameOutlineGraphic.geometry=this.layer.telemetry.frameOutline:this._frameOutlineGraphic.geometry=null,t.sensorTrail&&e.sensorTrail?this._sensorTrailGraphic.geometry=this.layer.telemetry.sensorTrail:this._sensorTrailGraphic.geometry=null,t.lineOfSight&&e.lineOfSight?this._lineOfSightGraphic.geometry=this.layer.telemetry.lineOfSight:this._lineOfSightGraphic.geometry=null,t.sensorLocation&&e.sensorLocation?this._sensorLocationGraphic.geometry=this.layer.telemetry.sensorLocation:this._sensorLocationGraphic.geometry=null,t.frameCenter&&e.frameCenter?this._frameCenterGraphic.geometry=this.layer.telemetry.frameCenter:this._frameCenterGraphic.geometry=null)}async _addOverlayMultipoint(){if(!this.layer.videoElement)return;const e=new A(this.layer.videoElement);this.addAttachHandles([(0,a.wB)((()=>[this.layer.frameHorizonPoints,this.layer.groundControlPoints]),(()=>{e.frameHorizonPoints=this.layer.frameHorizonPoints,e.groundControlPoints=this.layer.groundControlPoints}),a.Vh)]),this._overlayContainer.addChild(e),this.view.stage.requestRender()}};(0,i._)([(0,l.MZ)()],R.prototype,"graphicsView",void 0),(0,i._)([(0,l.MZ)()],R.prototype,"layer",void 0),(0,i._)([(0,l.MZ)()],R.prototype,"symbolColor",void 0),(0,i._)([(0,l.MZ)({type:u.A})],R.prototype,"visibleTelemetryElements",void 0),R=(0,i._)([(0,c.$)("esri.views.2d.layers.VideoLayerView2D")],R);const N=R},31394:(e,t,r)=>{r.d(t,{A:()=>o});var i=r(61551),s=r(8995),n=r(13692);class o extends s.f{renderChildren(e){for(const t of this.children)t.setTransform(e.state);if(super.renderChildren(e),this.attributeView.update(),this.children.some((e=>e.hasData))){switch(e.drawPhase){case i.S5.MAP:this._renderChildren(e,i.RI.All);break;case i.S5.HIGHLIGHT:this.hasHighlight&&this._renderHighlight(e)}this._boundsRenderer&&this._boundsRenderer.doRender(e)}}_renderHighlight(e){(0,n.lB)(e,!1,(e=>{this._renderChildren(e,i.RI.Highlight)}))}}}}]);
//# sourceMappingURL=9223.ba749617.chunk.js.map