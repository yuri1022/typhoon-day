"use strict";(self.webpackChunktyphoon=self.webpackChunktyphoon||[]).push([[1323],{15011:(e,t,n)=>{n.d(t,{EB:()=>h,Mj:()=>c,Ui:()=>f,w2:()=>y});var i=n(91967),o=n(94643),r=n(39314);const s=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function a(e){return e instanceof i.A}function l(e){return e instanceof o.A?Object.keys(e.items):a(e)?(0,r.oY)(e).keys():e?Object.keys(e):[]}function d(e,t){return e instanceof o.A?e.items[t]:e[t]}function u(e){return e?e.declaredClass:null}function p(e,t){const n=e.diff;if(n&&"function"==typeof n)return n(e,t);const i=l(e),o=l(t);if(0===i.length&&0===o.length)return;if(!i.length||!o.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};const r=o.filter((e=>!i.includes(e))),c=i.filter((e=>!o.includes(e))),h=i.filter((n=>o.includes(n)&&d(e,n)!==d(t,n))).concat(r,c).sort(),y=u(e);if(y&&s.has(y)&&h.length)return{type:"complete",oldValue:e,newValue:t};let f;const m=a(e)&&a(t);for(const s of h){const i=d(e,s),o=d(t,s);let r;if((m||"function"!=typeof i&&"function"!=typeof o)&&i!==o&&(null!=i||null!=o)){var g;if(n&&n[s]&&"function"==typeof n[s])r=null===(g=n[s])||void 0===g?void 0:g.call(n,i,o);else if(i instanceof Date&&o instanceof Date){if(i.getTime()===o.getTime())continue;r={type:"complete",oldValue:i,newValue:o}}else r="object"==typeof i&&"object"==typeof o&&u(i)===u(o)?p(i,o):{type:"complete",oldValue:i,newValue:o};null!=r&&(null!=f?f.diff[s]=r:f={type:"partial",diff:{[s]:r}})}}return f}function c(e,t){return h(e,t)}function h(e,t){if(null==e)return!1;const n=t.split(".");let i=e;for(const o of n){if("complete"===i.type)return!0;if("partial"!==i.type)return!1;{const e=i.diff[o];if(!e)return!1;i=e}}return!0}function y(e,t){if(!e)return!1;if("partial"===e.type){const n=Object.keys(e.diff);return 1===n.length&&n[0]===t}return!1}function f(e,t){if("function"!=typeof e&&"function"!=typeof t&&(null!=e||null!=t))return null==e||null==t||"object"==typeof e&&"object"==typeof t&&u(e)!==u(t)?{type:"complete",oldValue:e,newValue:t}:p(e,t)}},70373:(e,t,n)=>{n.d(t,{w:()=>s});var i=n(18690),o=(n(81806),n(30015)),r=n(61196);class s{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,t=arguments.length>1?arguments[1]:void 0;this._compareMinX=p,this._compareMinY=c,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),w.prune(),b.prune(),T.prune(),M.prune()}all(e){a(this._data,e)}search(e,t){let n=this._data;const i=this._toBBox;if(v(e,n))for(w.clear();n;){for(let o=0,r=n.children.length;o<r;o++){const r=n.children[o],s=n.leaf?i(r):r;v(e,s)&&(n.leaf?t(r):g(e,s)?a(r,t):w.push(r))}n=w.pop()}}collides(e){let t=this._data;const n=this._toBBox;if(!v(e,t))return!1;for(w.clear();t;){for(let i=0,o=t.children.length;i<o;i++){const o=t.children[i],r=t.leaf?n(o):o;if(v(e,r)){if(t.leaf||g(e,r))return!0;w.push(o)}}t=w.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}let t=this._build(e.slice(0,e.length),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new E([]),this}remove(e){if(!e)return this;let t,n=this._data,o=null,r=0,s=!1;const a=this._toBBox(e);for(T.clear(),M.clear();n||T.length>0;){var l;if(n||(n=T.pop(),o=T.data[T.length-1],r=null!==(l=M.pop())&&void 0!==l?l:0,s=!0),n.leaf&&(t=(0,i.qh)(n.children,e,n.children.length,n.indexHint),-1!==t))return n.children.splice(t,1),T.push(n),this._condense(T),this;s||n.leaf||!g(n,a)?o?(r++,n=o.children[r],s=!1):n=null:(T.push(n),M.push(r),r=0,o=n,n=n.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,n,i){const o=n-t+1;let r=this._maxEntries;if(o<=r){const i=new E(e.slice(t,n+1));return l(i,this._toBBox),i}i||(i=Math.ceil(Math.log(o)/Math.log(r)),r=Math.ceil(o/r**(i-1)));const s=new A([]);s.height=i;const a=Math.ceil(o/r),d=a*Math.ceil(Math.sqrt(r));_(e,t,n,d,this._compareMinX);for(let l=t;l<=n;l+=d){const t=Math.min(l+d-1,n);_(e,l,t,a,this._compareMinY);for(let n=l;n<=t;n+=a){const o=Math.min(n+a-1,t);s.children.push(this._build(e,n,o,i-1))}}return l(s,this._toBBox),s}_insert(e,t,n){const i=this._toBBox,o=n?e:i(e);T.clear();const r=function(e,t,n,i){for(;i.push(t),!0!==t.leaf&&i.length-1!==n;){let n,i=1/0,o=1/0;for(let r=0,s=t.children.length;r<s;r++){const s=t.children[r],a=h(s),l=f(e,s)-a;l<o?(o=l,i=a<i?a:i,n=s):l===o&&a<i&&(i=a,n=s)}t=n||t.children[0]}return t}(o,this._data,t,T);for(r.children.push(e),u(r,o);t>=0&&T.data[t].children.length>this._maxEntries;)this._split(T,t),t--;!function(e,t,n){for(let i=n;i>=0;i--)u(t.data[i],e)}(o,T,t)}_split(e,t){const n=e.data[t],i=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,i);const r=this._chooseSplitIndex(n,o,i);if(!r)return;const s=n.children.splice(r,n.children.length-r),a=n.leaf?new E(s):new A(s);a.height=n.height,l(n,this._toBBox),l(a,this._toBBox),t?e.data[t-1].children.push(a):this._splitRoot(n,a)}_splitRoot(e,t){this._data=new A([e,t]),this._data.height=e.height+1,l(this._data,this._toBBox)}_chooseSplitIndex(e,t,n){let i,o,r;i=o=1/0;for(let s=t;s<=n-t;s++){const t=d(e,0,s,this._toBBox),a=d(e,s,n,this._toBBox),l=m(t,a),u=h(t)+h(a);l<i?(i=l,r=s,o=u<o?u:o):l===i&&u<o&&(o=u,r=s)}return r}_chooseSplitAxis(e,t,n){const i=e.leaf?this._compareMinX:p,o=e.leaf?this._compareMinY:c;this._allDistMargin(e,t,n,i)<this._allDistMargin(e,t,n,o)&&e.children.sort(i)}_allDistMargin(e,t,n,i){e.children.sort(i);const o=this._toBBox,r=d(e,0,t,o),s=d(e,n-t,n,o);let a=y(r)+y(s);for(let l=t;l<n-t;l++){const t=e.children[l];u(r,e.leaf?o(t):t),a+=y(r)}for(let l=n-t-1;l>=t;l--){const t=e.children[l];u(s,e.leaf?o(t):t),a+=y(s)}return a}_condense(e){for(let t=e.length-1;t>=0;t--){const n=e.data[t];if(0===n.children.length)if(t>0){const o=e.data[t-1],r=o.children;r.splice((0,i.qh)(r,n,r.length,o.indexHint),1)}else this.clear();else l(n,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function a(e,t){let n=e;for(b.clear();n;){var i;if(!0===n.leaf)for(const e of n.children)t(e);else b.pushArray(n.children);n=null!==(i=b.pop())&&void 0!==i?i:null}}function l(e,t){d(e,0,e.children.length,t,e)}function d(e,t,n,i,o){o||(o=new E([])),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(let r,s=t;s<n;s++)r=e.children[s],u(o,e.leaf?i(r):r);return o}function u(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function p(e,t){return e.minX-t.minX}function c(e,t){return e.minY-t.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function y(e){return e.maxX-e.minX+(e.maxY-e.minY)}function f(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function m(e,t){const n=Math.max(e.minX,t.minX),i=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),r=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,r-i)}function g(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function v(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function _(e,t,n,i,o){const s=[t,n];for(;s.length;){const t=s.pop(),n=s.pop();if(t-n<=i)continue;const a=n+Math.ceil((t-n)/i/2)*i;(0,r.q)(e,a,n,t,o),s.push(n,a,a,t)}}const w=new o.A,b=new o.A,T=new o.A,M=new o.A({deallocator:void 0});class x{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class I extends x{constructor(){super(...arguments),this.height=1,this.indexHint=new i.vW}}class E extends I{constructor(e){super(),this.children=e,this.leaf=!0}}class A extends I{constructor(e){super(),this.children=e,this.leaf=!1}}},44081:(e,t,n)=>{n.d(t,{LF:()=>a,M9:()=>l,zu:()=>d});var i=n(50076),o=n(48611),r=n(7847),s=n(58503);function a(e,t,n){try{return function(e){if(!e||0===e.length)return null;if(function(e){const t=e[0];return!!t&&"scale"in t}(e)){const t=[];for(const n of e)t.push({scale:n.scale,value:d(n.value)});return t}return d(e)}(e)}catch(o){var i;null===n||void 0===n||null===(i=n.messages)||void 0===i||i.push(o)}return null}function l(e,t,n,i){try{const i=function(e){const t=(0,r.q)(e);return t?(0,s.dw)(t)?t.map((e=>e.toJSON())):t.map((e=>{let{scale:t,effects:n}=e;return{scale:t,value:n.map((e=>e.toJSON()))}})):null}(e);(0,o.sM)(n,i,t)}catch(l){i.messages&&i.messages.push(l)}}function d(e){if(null===e||void 0===e||!e.length)return"";const t=[];for(const n of e){let e=[];switch(n.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":e=[u(n,"amount")];break;case"blur":e=[u(n,"radius","pt")];break;case"hue-rotate":e=[u(n,"angle","deg")];break;case"drop-shadow":e=[u(n,"xoffset","pt"),u(n,"yoffset","pt"),u(n,"blurRadius","pt"),p(n,"color")];break;case"bloom":e=[u(n,"strength"),u(n,"radius","pt"),u(n,"threshold")]}const i="".concat(n.type,"(").concat(e.filter(Boolean).join(" "),")");(0,r.q)(i),t.push(i)}return t.join(" ")}function u(e,t,n){if(null==e[t])throw new i.A("effect:missing-parameter","Missing parameter '".concat(t,"' in ").concat(e.type," effect"),{effect:e});return n?e[t]+n:""+e[t]}function p(e,t){if(null==e[t])throw new i.A("effect:missing-parameter","Missing parameter '".concat(t,"' in ").concat(e.type," effect"),{effect:e});const n=e[t];return"rgba(".concat(n[0]||0,", ").concat(n[1]||0,", ").concat(n[2]||0,", ").concat(n[3]/255||0,")")}},33328:(e,t,n)=>{n.d(t,{F:()=>l});var i=n(81806),o=n(70373),r=n(2413);const s={minX:0,minY:0,maxX:0,maxY:0};function a(e,t,n){(function(e){s.minX=e[0],s.minY=e[1],s.maxX=e[2],s.maxY=e[3]})(t),e.search(s,n)}class l{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new o.w(9,(0,i.A)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach(((n,i)=>{e[t++]=i})),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((e=>this._idByBounds.has(e)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const e=(0,r.Ie)();for(const t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex(),a(this._index,e,(e=>t(this._idByBounds.get(e))))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},72547:(e,t,n)=>{n.d(t,{A:()=>y});var i=n(18690),o=n(50076),r=n(54099),s=n(76460),a=n(42294),l=n(2413),d=n(98618),u=n(33328),p=n(55167),c=n(33376);const h=(0,a.vt)();class y{constructor(e){this.geometryInfo=e,this._boundsStore=new u.F,this._featuresById=new Map,this._markedIds=new Set,this.events=new r.A,this.featureAdapter=c.T}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{null!=t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(e){if(null==this.fullBounds)return null;const[t,n,i,o]=this.fullBounds;return{xmin:t,ymin:n,xmax:i,ymax:o,spatialReference:(0,p.ag)(e)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}upsertMany(e){const t=e.map((e=>this._upsert(e)));return this._emitChanged(),t.filter(i.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t){for(const n of e){const e=this._boundsStore.get(n.objectId);e&&t((0,a.Jt)(h,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let e=!1;this._featuresById.forEach(((t,n)=>{this._markedIds.has(n)||(e=!0,this._remove(t))})),this._markedIds.clear(),e&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(e){var t;if(!e)return;const n=e.objectId;if(null==n)return void s.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new o.A("featurestore:invalid-feature","feature id is missing",{feature:e}));const i=this._featuresById.get(n);let r;if(this._markedIds.add(n),i?(e.displayId=i.displayId,r=this._boundsStore.get(n),this._boundsStore.delete(n)):null!=this.onFeatureAdd&&this.onFeatureAdd(e),null===(t=e.geometry)||void 0===t||null===(t=t.coords)||void 0===t||!t.length)return this._boundsStore.set(n,null),void this._featuresById.set(n,e);r=(0,d.jQ)(null!=r?r:(0,l.vt)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=r&&this._boundsStore.set(n,r),this._featuresById.set(n,e)}_upsert(e){var t;const n=null===e||void 0===e?void 0:e.objectId;if(null==n)return s.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new o.A("featurestore:invalid-feature","feature id is missing",{feature:e})),null;const i=this._featuresById.get(n);if(!i)return this._add(e),e;this._markedIds.add(n);const{geometry:r,attributes:a}=e;for(const o in a)i.attributes[o]=a[o];return r&&(i.geometry=r,this._boundsStore.set(n,null!==(t=(0,d.jQ)((0,l.vt)(),r,this.geometryInfo.hasZ,this.geometryInfo.hasM))&&void 0!==t?t:null)),i}_remove(e){null!=this.onFeatureRemove&&this.onFeatureRemove(e);const t=e.objectId;return this._markedIds.delete(t),this._boundsStore.delete(t),this._featuresById.delete(t),e}}},40296:(e,t,n)=>{n.d(t,{F0:()=>a,Vx:()=>u,e2:()=>c,f:()=>h});var i=n(81806),o=n(53084),r=n(8298),s=n(44460);function a(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?s.Cb:"esriGeometryPolyline"===e?s.yM:s.WR}}}const l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let d=1;function u(e,t){if((0,i.A)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let n="this".concat(p(t)," = null;");for(const t in e)n+="this".concat(p(t)," = ").concat(JSON.stringify(e[t]),";");const i=new Function("\n      return class AttributesClass$".concat(d++," {\n        constructor() {\n          ").concat(n,";\n        }\n      }\n    "))();return()=>new i}catch(n){return()=>({[t]:null,...e})}}function p(e){return l.test(e)?".".concat(e):'["'.concat(e,'"]')}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,o.o8)(e)}}]}function h(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:r.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},68705:(e,t,n)=>{n.d(t,{PB:()=>S,d4:()=>A,ZL:()=>I,sZ:()=>E,yC:()=>M,Vr:()=>x});var i=n(35143),o=(n(35238),n(91967)),r=n(50076),s=n(76460),a=n(87663),l=n(34154),d=n(46053),u=(n(81806),n(47249),n(85842)),p=n(65215),c=n(26346),h=n(80963),y=n(98618),f=n(20176),m=n(19902);class g{constructor(){this._featureLookup=new Map}static getInstance(){return g.instance||(g.instance=new g),g.instance}static resetInstance(){g.instance&&(g.instance=null)}deleteFromStore(e){e.forEach((e=>{this._featureLookup.delete(e)}))}readFromStoreByList(e){const t=[];return e.forEach((e=>{const n=this.readFromStoreById(e);n&&t.push(n)})),t}readFromStoreById(e){var t;return null!==(t=this._featureLookup.get(e))&&void 0!==t?t:null}writeToStore(e,t,n){const i=[];return e.forEach((e=>{if(null===e||void 0===e||!e.id)return;e.properties||(e.properties=[]);let o,r=null;if(n&&e.properties[n]&&(r=(0,y.Ux)(e.properties[n])),"originId"in e&&"destinationId"in e&&(e.properties.ESRI__ORIGIN_ID=e.originId,e.properties.ESRI__DESTINATION_ID=e.destinationId),e.properties[t]=e.id,e.id&&this._featureLookup.has(e.id)&&this._featureLookup.get(e.id).attributes){const i=this._featureLookup.get(e.id),s=JSON.parse(JSON.stringify(Object.assign(i.attributes,e.properties)));n&&e.properties[n]&&(s[n]=(0,m.rS)(e.properties[n])),o=new f.Om(r?JSON.parse(JSON.stringify(r)):null!==i&&void 0!==i&&i.geometry?JSON.parse(JSON.stringify(i.geometry)):null,s,null,e.properties[t])}else o=new f.Om(r?JSON.parse(JSON.stringify(r)):null,e.properties,null,e.properties[t]);this._featureLookup.set(e.id,o),i.push(o)})),i}}var v=n(52451),_=n(14476),w=n(35380),b=n(97015),T=n(76797);const M="ESRI__ID",x="ESRI__ORIGIN_ID",I="ESRI__DESTINATION_ID",E="ESRI__LAYOUT_GEOMETRY",A="ESRI__AGGREGATION_COUNT";let S=class extends o.A{constructor(e){var t,n,i;super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const o=new Map;null!==(t=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==t&&t.forEach((t=>{var n,i;t.name&&(o.set(t.name,"entity"),this._processingCacheUpdatesLookup.set(t.name,[]),e.inclusionModeDefinition&&!(null!==(n=e.inclusionModeDefinition)&&void 0!==n&&n.generateAllSublayers)||this.entityTypeNames.add(t.name),null===(i=t.properties)||void 0===i||i.forEach((e=>{var n;e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(t.name,{name:null!==(n=e.name)&&void 0!==n?n:"",geometryType:e.geometryType})})))})),null!==(n=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==n&&n.forEach((t=>{var n,i;t.name&&(o.set(t.name,"relationship"),this._processingCacheUpdatesLookup.set(t.name,[]),e.inclusionModeDefinition&&!(null!==(n=e.inclusionModeDefinition)&&void 0!==n&&n.generateAllSublayers)||this.relationshipTypeNames.add(t.name),null===(i=t.properties)||void 0===i||i.forEach((e=>{var n;e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(t.name,{name:null!==(n=e.name)&&void 0!==n?n:"",geometryType:e.geometryType})})))})),null===(i=e.inclusionModeDefinition)||void 0===i||i.namedTypeDefinitions.forEach(((t,n)=>{var i;if("entity"===o.get(n))this.entityTypeNames.add(n);else{var r;if("relationship"!==o.get(n))return s.A.getLogger(this).warn("A named type, ".concat(n,", was in the inclusion list that wasn't in the data model and will be removed")),void(null===(r=e.inclusionModeDefinition)||void 0===r||r.namedTypeDefinitions.delete(n));this.relationshipTypeNames.add(n)}const l=new Map;null!==(i=t.members)&&void 0!==i&&i.forEach((e=>{(0,a.tE)(this.memberIdTypeLookup,e.id,(()=>new Set)).add(n);const t=this.getById(e.id);t&&l.set(e.id,t)})),this.sublayerCaches.set(n,l)}))}addToLayer(e){e.forEach((e=>{let{typeName:t,id:n}=e;if(!this.inclusionModeDefinition)throw new r.A("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){const e=this.inclusionModeDefinition.namedTypeDefinitions.get(t);e.members||(e.members=new Map),e.members.set(n,{id:n}),(0,a.tE)(this.memberIdTypeLookup,n,(()=>new Set)).add(t)}}else{const e=new Map;e.set(n,{id:n}),this.inclusionModeDefinition.namedTypeDefinitions.set(t,{useAllData:!1,members:e}),(0,a.tE)(this.memberIdTypeLookup,n,(()=>new Set)).add(t)}}))}getById(e){return g.getInstance().readFromStoreById(e)}async getData(e,t,n){var i;if(t.objectType.name&&null!==(i=this.inclusionModeDefinition)&&void 0!==i&&i.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let o;if(o=e||new b.A({where:"1=1",outFields:["*"]}),"link-chart"===t.parentCompositeLayer.type){var r,s,a;const e=t.parentCompositeLayer,n=this._processingCacheUpdatesLookup.get(null!==(r=t.objectType.name)&&void 0!==r?r:""),i=o.outFields;i&&1===i.length&&i[0]===M&&"1=1"===o.where||await Promise.all(null!==n&&void 0!==n?n:[]);const l=this.sublayerCaches.has(null!==(s=t.objectType.name)&&void 0!==s?s:"")?Array.from(null===(a=this.sublayerCaches.get(t.objectType.name))||void 0===a?void 0:a.values()):[],d=[];return l.forEach((n=>{this.relationshipTypeNames.has(t.objectType.name)?n.geometry=e.relationshipLinkChartDiagramLookup.get(n.attributes[t.objectIdField]):n.geometry=e.entityLinkChartDiagramLookup.get(n.attributes[t.objectIdField]),n.attributes[E]=n.geometry,d.push(n)})),d}return this.retrieveDataFromService(o,t,n)}async getConnectedRecordIds(e,t){const n=[];let i="";const o=[],r=new Map;if(e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const n of this.memberIdTypeLookup.get(e)){var t;if(!this.entityTypeNames.has(n))return;r.has(n)?null===(t=r.get(n))||void 0===t||t.push(e):r.set(n,[e])}})),t&&0!==(null===t||void 0===t?void 0:t.length)){for(const e of t)i=i+e+"|";i=i.slice(0,-1)}return r.forEach(((e,r)=>{let a;a=t&&0!==(null===t||void 0===t?void 0:t.length)?"MATCH (n:".concat(r,")-[r:").concat(i,"]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]"):"MATCH (n:".concat(r,")-[r]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]");const l=new Promise((t=>{(async()=>{const t=(await(0,_.executeQueryStreaming)(this.knowledgeGraph,new w.A({openCypherQuery:a,bindParameters:{ids:e}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:i}=await t.read();if(e)break;for(let t=0;t<i.length;t++){const e=i[t];n.push({id:e[0],typeName:e[1]}),n.push({id:e[2],typeName:e[3]})}}}catch(i){if("AbortError"!==i.name)throw i;s.A.getLogger(this).info("Request aborted as expected")}})().then((()=>{t()}))}));o.push(l)})),this.refreshCacheContent(),await Promise.all(o),n}async getAttachedRelationships(e,t){const n=[],i=(await(0,_.executeQueryStreaming)(this.knowledgeGraph,new w.A({openCypherQuery:"MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",bindParameters:{nodeIds:e,relationshipExclusionIds:t}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:t}=await i.read();if(e)break;for(let i=0;i<t.length;i++){const e=t[i];n.push({id:e[0],typeName:e[1]})}}}catch(o){if("AbortError"!==o.name)throw o;s.A.getLogger(this).info("Request aborted as expected")}return n}async refreshCacheContent(e,t,n){var i,o,s,l,d;let u=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const p=g.getInstance(),c=[],h=new Map,y=new Map;null!==(i=this.knowledgeGraph.dataModel.entityTypes)&&void 0!==i&&i.forEach((e=>{e.name&&y.set(e.name,e)})),null!==(o=this.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==o&&o.forEach((e=>{e.name&&y.set(e.name,e)})),e||this.inclusionModeDefinition?e?e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const n of this.memberIdTypeLookup.get(e)){var t;h.has(n)?null===(t=h.get(n))||void 0===t||t.push(e):h.set(n,[e])}})):null===(s=this.inclusionModeDefinition)||void 0===s||null===(s=s.namedTypeDefinitions)||void 0===s||s.forEach(((e,t)=>{e.useAllData?h.set(t,null):e.members&&e.members.forEach((e=>{var n;h.has(t)&&null!==h.get(t)?null===(n=h.get(t))||void 0===n||n.push(e.id):h.set(t,[e.id])}))})):(null!==(l=this.knowledgeGraph.dataModel.entityTypes)&&void 0!==l&&l.forEach((e=>{e.name&&h.set(e.name,null)})),null===(d=this.knowledgeGraph.dataModel.entityTypes)||void 0===d||d.forEach((e=>{e.name&&h.set(e.name,null)})));for(const[m,g]of h){var f;const e=new Promise((e=>{(async()=>{var e;const i=new Set,o=[];let s,l="",d=!1;if(t||null!==(e=y.get(m))&&void 0!==e&&null!==(e=e.properties)&&void 0!==e&&e.forEach((e=>{e.name&&i.add(e.name)})),n&&this.geographicLookup.has(m)){var c;const e=null===(c=this.geographicLookup.get(m))||void 0===c?void 0:c.name;e&&i.add(e)}if(this.entityTypeNames.has(m))l="MATCH (n:".concat(m,") ").concat(g?"WHERE id(n) IN $ids ":"","return ID(n)"),i.forEach((e=>{l+=", n.".concat(e),o.push(e)}));else{if(!this.relationshipTypeNames.has(m))throw new r.A("knowledge-graph:layer-data-manager","The graph type of ".concat(m," could not be determined. Was this type set in the KG data model and inclusion definition?"));d=!0,l="MATCH ()-[n:".concat(m,"]->() ").concat(g?"WHERE id(n) IN $ids ":"","return ID(n), id(startNode(n)), id(endNode(n))"),i.forEach((e=>{l+=", n.".concat(e),o.push(e)}))}s=new w.A(g?{openCypherQuery:l,bindParameters:{ids:g}}:{openCypherQuery:l});const h=(await(0,_.executeQueryStreaming)(this.knowledgeGraph,s)).resultRowsStream.getReader();for(;;){var f,v,b,T;const{done:e,value:t}=await h.read();if(e)break;const n=[];for(let s=0;s<t.length;s++){const e=t[s];let i=0,r=0;const l={properties:{}};for(l.id=e[i],i++,r++,d&&(l.originId=e[i],i++,r++,l.destinationId=e[i],i++,r++,(0,a.tE)(this.nodeConnectionsLookup,l.originId,(()=>new Set)).add(l.id),(0,a.tE)(this.nodeConnectionsLookup,l.destinationId,(()=>new Set)).add(l.id),(0,a.tE)(this.relationshipConnectionsLookup,l.id,(()=>[l.originId,l.destinationId])));i<e.length;i++)l.properties[o[i-r]]=e[i];n.push(l)}const i=p.writeToStore(n,M,null===(f=this.geographicLookup.get(m))||void 0===f?void 0:f.name);this.sublayerCaches.has(m)||this.sublayerCaches.set(m,new Map),u&&!(null!==(v=this.inclusionModeDefinition)&&void 0!==v&&v.namedTypeDefinitions.has(m))&&null!==(b=this.inclusionModeDefinition)&&void 0!==b&&b.namedTypeDefinitions.set(m,{useAllData:!1,members:new Map}),u&&(null===(T=this.inclusionModeDefinition)||void 0===T||!T.namedTypeDefinitions.get(m).members)&&(this.inclusionModeDefinition.namedTypeDefinitions.get(m).members=new Map);const r=this.sublayerCaches.get(m);i.forEach((e=>{var t,n;null!==r&&void 0!==r&&r.set(e.attributes[M],e),u&&(null===(t=this.inclusionModeDefinition)||void 0===t||!t.namedTypeDefinitions.get(m).members.has(e.attributes[M]))&&(null!==(n=this.inclusionModeDefinition)&&void 0!==n&&n.namedTypeDefinitions.get(m).members.set(e.attributes[M],{id:e.attributes[M]}),(0,a.tE)(this.memberIdTypeLookup,e.attributes[M],(()=>new Set)).add(m))}))}})().then((()=>{e(null)}))}));c.push(e),null===(f=this._processingCacheUpdatesLookup.get(m))||void 0===f||f.push(e)}await Promise.all(c)}removeFromLayer(e){const t=new Set,n=new Set(e.map((e=>e.id)));for(const s of e){var i,o,r;t.add(s.typeName),1===(null===(i=this.memberIdTypeLookup.get(s.id))||void 0===i?void 0:i.size)?this.memberIdTypeLookup.delete(s.id):null===(o=this.memberIdTypeLookup.get(s.id))||void 0===o||o.delete(s.typeName),null===(r=this.inclusionModeDefinition)||void 0===r||r.namedTypeDefinitions.forEach(((e,t)=>{var n;t===s.typeName&&(null===(n=e.members)||void 0===n?void 0:n.has(s.id))&&e.members.delete(s.id)}))}t.forEach((e=>{var t;null===(t=this.sublayerCaches.get(e))||void 0===t||t.forEach(((t,i)=>{var o;n.has(i)&&(null===(o=this.sublayerCaches.get(e))||void 0===o||o.delete(i))}))}))}async retrieveDataFromService(e,t,n){var i,o,s;const a=g.getInstance(),d=new Set,u=[];let y,f="",m=[];const b="relationship"===t.graphType,x=null===(i=this.inclusionModeDefinition)||void 0===i||null===(i=i.namedTypeDefinitions)||void 0===i||null===(i=i.get(t.objectType.name))||void 0===i?void 0:i.useAllData,I=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let E=!x&&I?Array.from(I).sort():null;if(null!==(o=this.inclusionModeDefinition)&&void 0!==o&&null!==(o=o.namedTypeDefinitions)&&void 0!==o&&null!==(o=o.get(t.objectType.name))&&void 0!==o&&o.useAllData)(null===(s=this.inclusionModeDefinition)||void 0===s||null===(s=s.namedTypeDefinitions)||void 0===s||null===(s=s.get(t.objectType.name))||void 0===s?void 0:s.useAllData)&&null!=e.objectIds&&(E=e.objectIds);else if(null!=e.objectIds&&E&&E.length>0){const t=e.objectIds;e.objectIds=E.filter((e=>t.includes(e)))}else if(null!=e.objectIds)E=e.objectIds;else{var A,S,N;if(null!==(A=this.inclusionModeDefinition)&&void 0!==A&&A.namedTypeDefinitions.has(t.objectType.name)&&(null===(S=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))||void 0===S||!S.members||(null===(N=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))||void 0===N||null===(N=N.members)||void 0===N?void 0:N.size)<1))return e.objectIds=[],[];e.objectIds=E}if(null!=e.outFields){const n=e.outFields;n.includes("*")?t.fields.forEach((e=>{d.add(e.name)})):n.forEach((e=>{e!==M&&e!==t.geometryFieldName&&d.add(e)}))}if(null!=e.geometry){var D,R,B;const n=e.geometry;let i;const o=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,s=null===o||void 0===o?void 0:o.spatialReference,a=null===o||void 0===o||null===(D=o.serviceCapabilities)||void 0===D?void 0:D.geometryCapabilities;let m=null===a||void 0===a?void 0:a.geometryMaxBoundingRectangleSizeX,g=null===a||void 0===a?void 0:a.geometryMaxBoundingRectangleSizeY;if(null===n||void 0===n||null===(R=n.extent)||void 0===R||!R.spatialReference||null!==(B=n.spatialReference)&&void 0!==B&&B.isWGS84?i=n.extent:(await(0,c.initializeProjection)(n.extent.spatialReference,h.KK),i=(0,c.project)(n.extent,h.KK)),m&&g&&s){if(4326!==s.wkid){const e=new T.A({spatialReference:s,xmax:m,ymax:g}),t=(0,c.project)(e,h.KK);m=t.xmax,g=t.ymax}if(i.xmax-i.xmin>m)throw new r.A("knowledge-graph:layer-data-manager","Extent x bounds should be within ".concat(m,"\xb0 latitude, limit exceeded"));if(i.ymax-i.ymin>g)throw new r.A("knowledge-graph:layer-data-manager","Extent y bounds should be within ".concat(g,"\xb0 longitude, limit exceeded"))}if(null!=e.where&&"1=1"!==e.where){const n=await(0,l.G)(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach((e=>{n.fieldNames.includes(e.name)&&d.add(e.name)}))}f=b?"Match ()-[n:".concat(t.objectType.name,"]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.").concat(t.geometryFieldName,") return ID(n), id(startNode(r)), id(endNode(r))"):"Match (n:".concat(t.objectType.name,") WHERE esri.graph.ST_Intersects($param_filter_geom, n.").concat(t.geometryFieldName,") return ID(n)"),t.geometryFieldName&&d.add(t.geometryFieldName),d.forEach((e=>{f+=", n.".concat(e),u.push(e)})),y=new w.A({openCypherQuery:f,bindParameters:{param_filter_geom:new p.A({rings:(0,v.DX)(i)})}})}else{let n="";if(null!=e.where&&"1=1"!==e.where){const i=await(0,l.G)(e.where,t.fieldsIndex);t.fields.forEach((e=>{i.fieldNames.includes(e.name)&&d.add(e.name)}));const o=new Set(["column-reference","string","number","binary-expression"]),r=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let s=!1;const a=e=>{if("column-reference"===e.type)return"n.".concat(e.column);if("string"===e.type)return"'".concat(e.value,"'");if("number"===e.type)return"".concat(e.value);if("binary-expression"===e.type&&o.has(e.left.type)&&o.has(e.right.type)&&r.has(e.operator))return"".concat(a(e.left)," ").concat(e.operator," ").concat(a(e.right));if("binary-expression"===e.type&&"LIKE"===e.operator){let t="";if("function"===e.left.type&&"column-reference"===e.left.args.value[0].type)t+="lower(n.".concat(e.left.args.value[0].column,")");else{if("column-reference"!==e.left.type)return s=!0,"";t+="lower(n.".concat(e.left.column,")")}if(t+=" CONTAINS (","string"!==e.right.type)return s=!0,"";{let n=e.right.value;"%"===n.charAt(0)&&(n=n.slice(1)),"%"===n.charAt(n.length-1)&&(n=n.slice(0,-1)),t+="'".concat(n.toLowerCase(),"')")}return t}return s=!0,""};n=a(i.parseTree),s&&(n="")}let i="";i=b?"Match ()-[n:".concat(t.objectType.name,"]->()"):"Match (n:".concat(t.objectType.name,")");let o=!1;E&&(o=!0,i+=" WHERE ID(n) IN $ids"),n&&(i+=o?" AND":" WHERE",i+=" ".concat(n)),i+=" return ID(n)",b&&(i+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&d.add(t.geometryFieldName),d.forEach((e=>{i+=", n.".concat(e),u.push(e)})),y=new w.A(E?{openCypherQuery:i,bindParameters:{ids:E}}:{openCypherQuery:i})}const L=(await(0,_.executeQueryStreaming)(t.parentCompositeLayer.dataManager.knowledgeGraph,y,n)).resultRowsStream.getReader();for(;;){var j;const{done:e,value:n}=await L.read();if(e)break;const i=[];for(let t=0;t<n.length;t++){const e=n[t];let o=0,r=0;const s={properties:{}};for(s.id=e[o],o++,r++,b&&(s.originId=e[o],o++,r++,s.destinationId=e[o],o++,r++);o<e.length;o++)s.properties[u[o-r]]=e[o];i.push(s)}m=m.concat(a.writeToStore(i,M,null===(j=t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name))||void 0===j?void 0:j.name))}return m}};(0,i._)([(0,d.MZ)()],S.prototype,"knowledgeGraph",void 0),(0,i._)([(0,d.MZ)()],S.prototype,"inclusionModeDefinition",void 0),(0,i._)([(0,d.MZ)()],S.prototype,"entityTypeNames",void 0),(0,i._)([(0,d.MZ)()],S.prototype,"relationshipTypeNames",void 0),(0,i._)([(0,d.MZ)()],S.prototype,"geographicLookup",void 0),(0,i._)([(0,d.MZ)()],S.prototype,"sublayerCaches",void 0),(0,i._)([(0,d.MZ)()],S.prototype,"nodeConnectionsLookup",void 0),(0,i._)([(0,d.MZ)()],S.prototype,"relationshipConnectionsLookup",void 0),(0,i._)([(0,d.MZ)()],S.prototype,"memberIdTypeLookup",void 0),S=(0,i._)([(0,u.$)("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],S)},83716:(e,t,n)=>{n.d(t,{A:()=>V});var i=n(35143),o=(n(35238),n(16868)),r=(n(63844),n(14873),n(47662),n(72690),n(86946),n(71832),n(5766),n(35039),n(86616)),s=n(31382),a=n(53084),l=n(77717),d=(n(16783),n(46053)),u=(n(81806),n(76460),n(85842)),p=n(17707),c=n(49140),h=n(26346),y=n(13312),f=n(80963),m=n(25515),g=n(72547),v=n(16744),_=n(40296),w=n(68705);n(47249);const b=(0,n(76350).p)(),T=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return(0,i._)([(0,d.MZ)(b.fields)],t.prototype,"fields",void 0),(0,i._)([(0,d.MZ)(b.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=(0,i._)([(0,u.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],t),t};var M=n(65624),x=n(74440),I=n(52908),E=n(37534),A=n(21617),S=n(5682),N=n(78817),D=n(95363),R=n(54490),B=n(44135),L=n(53430),j=n(71401),k=n(27937),C=n(77725),O=n(97015),Z=n(30973),F=n(59989),q=n(76797),G=n(65215),Y=n(23701),P=n(31608);function Q(e){if(!e.json)return e;e.json.write=X(e.json.write);const t=e.json.origins;if(!t)return e;let n;for(n in t){const e=t[n];e&&(e.write=X(e.write))}return e}function X(e){return"object"==typeof e&&e?(!1!==e.enabled&&(e.overridePolicy=function(e){const{target:t,writer:n,overridePolicy:i,...o}=e;return function(e,t){const n=$.call(this,e,t);return n.enabled?{...o,...n}:n}}(e)),e):!0===e?J():e}function J(){return{overridePolicy:$}}function $(e,t){const n=!!this.geometryType;let i={enabled:n};return n&&(i={...i,...U.call(this,e,t)}),i}function U(e,t){return{ignoreOrigin:this.originIdOf(t)>c.Gr.DEFAULTS}}let z=class extends(T((0,I.J)((0,x.F)((0,M.dM)((0,E.f)((0,N.e)((0,S.j)((0,A.J)((0,l.P)(m.A)))))))))){constructor(e){var t;super(e),t=this,this.blendMode="normal",this.capabilities=(0,_.f)(!1,!1),this.charts=null,this.definitionExpression=null,this.displayField="",this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.labelingInfo=null,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=w.yC,this.objectType=null,this.opacity=1,this.orderBy=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then((()=>{const e=new MessageChannel;return new F.A(e.port1,{channel:e,client:{queryFeatures:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=O.A.fromJSON(e);return t.queryFeaturesJSON(i,n)}}}),[e.port2]}))},this.title=null,this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){var e;const t=[];return null!==(e=this.objectType)&&void 0!==e&&null!==(e=e.properties)&&void 0!==e&&e.forEach((e=>{const n="esriFieldTypeOID"===e.fieldType?"esriFieldTypeInteger":e.fieldType;t.push(B.A.fromJSON({name:e.name,type:n,alias:e.alias,defaultValue:e.defaultValue,editable:e.editable,nullable:e.nullable}))})),t.push(B.A.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),B.A.fromJSON({name:w.d4,type:"esriFieldTypeInteger",alias:w.d4,editable:!1})),t}get geometryType(){var e,t,n;if("link-chart"===(null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.type))return"relationship"===this.graphType?"polyline":"point";const i=null===(t=this.parentCompositeLayer)||void 0===t?void 0:t.dataManager.geographicLookup.get(null===(n=this.objectType)||void 0===n?void 0:n.name),o=null===i||void 0===i?void 0:i.geometryType;return o&&"esriGeometryNull"!==o?P.g.fromJSON(o):null}get geometryFieldName(){var e,t,n,i;if("link-chart"===(null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.type))return w.sZ;const o=null===(t=this.parentCompositeLayer)||void 0===t?void 0:t.dataManager.geographicLookup.get(null===(n=this.objectType)||void 0===n?void 0:n.name);return null!==(i=null===o||void 0===o?void 0:o.name)&&void 0!==i?i:null}get graphTypeName(){var e;return null===(e=this.objectType)||void 0===e?void 0:e.name}get hasM(){var e,t,n,i;const o=null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.dataManager.geographicLookup.get(null===(t=this.objectType)||void 0===t?void 0:t.name),r=null===o||void 0===o?void 0:o.name,s=r?null===(n=this.objectType)||void 0===n||null===(n=n.properties)||void 0===n?void 0:n[r]:null;return null!==(i=null===s||void 0===s?void 0:s.hasM)&&void 0!==i&&i}get hasZ(){var e,t,n,i;const o=null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.dataManager.geographicLookup.get(null===(t=this.objectType)||void 0===t?void 0:t.name),r=null===o||void 0===o?void 0:o.name,s=r?null===(n=this.objectType)||void 0===n||null===(n=n.properties)||void 0===n?void 0:n[r]:null;return null!==(i=null===s||void 0===s?void 0:s.hasZ)&&void 0!==i&&i}set renderer(e){(0,L.yp)(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){var e;return this._isOverridden("renderer")?this._get("renderer"):"link-chart"===(null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.type)?"relationship"===this.graphType?(0,r.r)((0,_.F0)(P.g.toJSON("polyline")).renderer):(0,r.r)((0,_.F0)(P.g.toJSON("point")).renderer):(0,r.r)((0,_.F0)(P.g.toJSON(this.geometryType)).renderer)}get spatialReference(){var e,t;return null!==(e=null===(t=this.parentCompositeLayer)||void 0===t||null===(t=t.dataManager)||void 0===t||null===(t=t.knowledgeGraph)||void 0===t||null===(t=t.dataModel)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:y.A.WGS84}writeTitle(e,t){t.title=null!==e&&void 0!==e?e:"Layer"}createPopupTemplate(e){return(0,Z.tn)(this,e)}createQuery(){return new O.A({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];return null}getFieldDomain(e,t){return null}async queryFeatures(e,t){const{resolvedQuery:n,queryEngine:i}=await this._setupQueryObjects(e),o=C.A.fromJSON(await i.executeQuery(n.toJSON(),null===t||void 0===t?void 0:t.signal));return o.features.forEach((e=>{e.sourceLayer=this})),o}async queryFeaturesJSON(e,t){const{resolvedQuery:n,queryEngine:i}=await this._setupQueryObjects(e);return await i.executeQuery(n.toJSON(),null===t||void 0===t?void 0:t.signal)}async queryFeatureCount(e,t){const{resolvedQuery:n,queryEngine:i}=await this._setupQueryObjects(e);return i.executeQueryForCount(n.toJSON(),null===t||void 0===t?void 0:t.signal)}async queryExtent(){var e,t,n,i;let o=arguments.length>1?arguments[1]:void 0;const r={...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},returnGeometry:!0},{resolvedQuery:s,queryEngine:a}=await this._setupQueryObjects(r),l=await a.executeQueryForExtent(s.toJSON(),null===o||void 0===o?void 0:o.signal);let d;return d=null!=(null===(e=l.extent)||void 0===e?void 0:e.xmin)&&null!=(null===(t=l.extent)||void 0===t?void 0:t.xmax)&&null!=(null===(n=l.extent)||void 0===n?void 0:n.ymin)&&null!=(null===(i=l.extent)||void 0===i?void 0:i.ymax)?new q.A(l.extent):new q.A,{count:l.count,extent:d}}async queryObjectIds(e,t){const n=O.A.from(e);let i;if("link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)i=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(n,this,t);i=this.loadQueryEngine(e)}return i.executeQueryForIds(n.toJSON(),null===t||void 0===t?void 0:t.signal)}loadQueryEngine(e){const t=new g.A({geometryType:P.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),n=new v.d({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:P.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:null,featureStore:t});return n.featureStore.addMany(e),n}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new O.A({where:"1=1",outFields:[w.yC]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}async _setupQueryObjects(e,t){var n;const i=O.A.from(e),o=i.geometry;let r;if(o&&!(null!==(n=o.spatialReference)&&void 0!==n&&n.isWGS84)&&(await(0,h.initializeProjection)(o.spatialReference,f.KK),i.geometry=(0,h.project)(o instanceof G.A||o instanceof Y.A?o:o.extent,f.KK)),"link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)r=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(i,this,t);r=this.loadQueryEngine(e)}return{resolvedQuery:i,queryEngine:r}}};(0,i._)([(0,d.MZ)(Q((0,a.o8)(M.sU)))],z.prototype,"blendMode",void 0),(0,i._)([(0,d.MZ)()],z.prototype,"capabilities",void 0),(0,i._)([(0,d.MZ)({json:{origins:{"web-scene":{write:!1}},write:J()}})],z.prototype,"charts",void 0),(0,i._)([(0,d.MZ)({readOnly:!0})],z.prototype,"defaultPopupTemplate",null),(0,i._)([(0,d.MZ)({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],z.prototype,"definitionExpression",void 0),(0,i._)([(0,d.MZ)()],z.prototype,"displayField",void 0),(0,i._)([(0,d.MZ)(Q((0,a.o8)(M.LF)))],z.prototype,"effect",void 0),(0,i._)([(0,d.MZ)()],z.prototype,"elevationInfo",void 0),(0,i._)([(0,d.MZ)(Q((0,a.o8)(x.Y)))],z.prototype,"featureEffect",void 0),(0,i._)([(0,d.MZ)(Q((0,a.o8)(R.d)))],z.prototype,"featureReduction",null),(0,i._)([(0,d.MZ)()],z.prototype,"fields",null),(0,i._)([(0,d.MZ)()],z.prototype,"geometryType",null),(0,i._)([(0,d.MZ)()],z.prototype,"geometryFieldName",null),(0,i._)([(0,d.MZ)({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],z.prototype,"graphType",void 0),(0,i._)([(0,d.MZ)({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],z.prototype,"graphTypeName",null),(0,i._)([(0,d.MZ)()],z.prototype,"hasM",null),(0,i._)([(0,d.MZ)()],z.prototype,"hasZ",null),(0,i._)([(0,d.MZ)({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],z.prototype,"id",void 0),(0,i._)([(0,d.MZ)(Q((0,a.o8)(D.kF)))],z.prototype,"labelsVisible",void 0),(0,i._)([(0,d.MZ)({type:[j.A],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:k.w,write:J()}})],z.prototype,"labelingInfo",void 0),(0,i._)([(0,d.MZ)({readOnly:!0,json:{read:!1,write:{writer(e,t){t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],z.prototype,"layerType",void 0),(0,i._)([(0,d.MZ)(Q((0,a.o8)(D.fV)))],z.prototype,"legendEnabled",void 0),(0,i._)([(0,d.MZ)(Q((0,a.o8)(D.hG)))],z.prototype,"maxScale",void 0),(0,i._)([(0,d.MZ)(Q((0,a.o8)(D.hn)))],z.prototype,"minScale",void 0),(0,i._)([(0,d.MZ)()],z.prototype,"objectIdField",void 0),(0,i._)([(0,d.MZ)()],z.prototype,"objectType",void 0),(0,i._)([(0,d.MZ)(Q((0,a.o8)(D.ke)))],z.prototype,"opacity",void 0),(0,i._)([(0,d.MZ)(Q((0,a.o8)(E.n)))],z.prototype,"orderBy",void 0),(0,i._)([(0,d.MZ)()],z.prototype,"parentCompositeLayer",void 0),(0,i._)([(0,d.MZ)(Q((0,a.o8)(D.M6)))],z.prototype,"popupEnabled",void 0),(0,i._)([(0,d.MZ)({type:o.A,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],z.prototype,"popupTemplate",void 0),(0,i._)([(0,d.MZ)({type:Number,json:{write:{overridePolicy:U}}})],z.prototype,"refreshInterval",void 0),(0,i._)([(0,d.MZ)({types:s.H,json:{name:"layerDefinition.drawingInfo.renderer",write:J()}})],z.prototype,"renderer",null),(0,i._)([(0,d.MZ)()],z.prototype,"source",void 0),(0,i._)([(0,d.MZ)()],z.prototype,"spatialReference",null),(0,i._)([(0,d.MZ)({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],z.prototype,"title",void 0),(0,i._)([(0,p.K)("title")],z.prototype,"writeTitle",null),(0,i._)([(0,d.MZ)({json:{read:!1}})],z.prototype,"type",void 0),(0,i._)([(0,d.MZ)(Q((0,a.o8)(N.B)))],z.prototype,"useViewTime",void 0),(0,i._)([(0,d.MZ)({type:Boolean,json:{name:"visibility",write:J()}})],z.prototype,"visible",void 0),z=(0,i._)([(0,u.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],z);const V=z},52451:(e,t,n)=>{n.d(t,{DX:()=>m,_s:()=>v,aq:()=>g,fe:()=>_});var i,o=n(3825),r=n(50076),s=n(87663),a=(n(98618),n(14476)),l=n(35380);n(35238),n(13312);!function(e){e.ELEMENTUID="ELEMENTUID",e.TYPENAME="TYPENAME"}(i||(i={}));i.ELEMENTUID,i.TYPENAME;var d,u;!function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"}(d||(d={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(u||(u={}));var p,c,h,y,f=n(57502);n(31830);function m(e){if(!e.spatialReference.isWGS84)throw new r.A("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map((e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]))}async function g(e,t){var n;const i=[],o=new Map,r=[];if(null!==(n=t.dataModel)&&void 0!==n&&n.relationshipTypes)for(const a of t.dataModel.relationshipTypes)a.name&&o.set(a.name,[]);for(const a of e){var s;o.has(a.typeName)&&(null===(s=o.get(a.typeName))||void 0===s||s.push(a.id))}for(const[d,u]of o){if(u.length<1)continue;const e=new l.A({openCypherQuery:"MATCH (n)-[r:".concat(d,"]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]"),bindParameters:{ids:u}});r.push((0,a.executeQueryStreaming)(t,e).then((async e=>{const t=e.resultRowsStream.getReader();for(;;){const{done:e,value:n}=await t.read();if(e)break;for(const t of n)i.push({id:t[0],typeName:t[1]}),i.push({id:t[2],typeName:t[3]})}})))}return await Promise.all(r),i}async function v(e,t){var n;null!==(n=t)&&void 0!==n||(t=!1);const i={generateAllSublayers:t,namedTypeDefinitions:new Map};return await w(e).then((e=>{b(e,i)})),i}async function _(e){const t=await(0,f.I)(),n=new t.MapOfObjectIdentifierSets;!function(e,t,n){for(const[i,o]of n.namedTypeDefinitions){if(!o.members||o.useAllData)continue;const n=o.members.keys(),r=new t.GlobalIdArray,s=new t.ObjectIdentifierSet;for(const e of n)r.add_globalid(e);s.set_globalid_array(r),r.delete(),e.put_identifier_set(i,s),s.delete()}}(n,t,e);const i=new t.MapOfObjectIdentifierSetsEncoder;try{i.set_map_of_identifier_sets(n),i.encode();const e=i.get_encoding_result();if(0!==e.error.error_code)throw new r.A("knowledge-graph:layer-support-utils",e.error.error_message);const t=structuredClone(e.get_byte_buffer());return i.delete(),t}finally{n.delete()}}async function w(e){const t=await(0,o.A)(e,{responseType:"array-buffer"}),n=await t.data;return async function(e){const t=new((await(0,f.I)()).MapOfObjectIdentifierSetsDecoder),n=t.decode(new Uint8Array(e)),i=new Map;if(0!==n.error_code)throw new r.A("knowledge-graph:layer-support-utils",n.error_message);const o=t.get_map_of_identifier_sets(),s=o.keys,a=s.size();for(let l=0;l<a;l++){const e=s.get(l),t=o.query_identifier_set(e),n=[];if(t.id_array_type.value===y.GLOBALID_ARRAY){const e=t.get_globalid_array(),i=e.count();for(let t=0;t<i;t++)n.push(e.get_globalid_at(t))}else{if(t.id_array_type.value!==y.IDENTIFIER_ARRAY)throw new r.A("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const e=t.get_identifier_array(),i=e.count();for(let t=0;t<i;t++)n.push(e.get_identifier_at(t).toString())}}i.set(e,n)}return t.delete(),i}(new Uint8Array(n))}function b(e,t){for(const[n,i]of e){const e=(0,s.tE)(t.namedTypeDefinitions,n,(()=>({useAllData:!1,members:new Map})));for(const t of i)e.members.has(t)||e.members.set(t,{id:t})}return t}!function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"}(p||(p={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(c||(c={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(h||(h={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(y||(y={}))},65624:(e,t,n)=>{n.d(t,{LF:()=>d,dM:()=>u,sU:()=>a});var i=n(35143),o=n(46053),r=(n(81806),n(76460),n(47249),n(85842)),s=n(44081);const a={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}},l={read:{reader:s.LF},write:{allowNull:!0,writer:s.M9}},d={json:{read:!1,write:!1,origins:{"web-map":l,"portal-item":l}}},u=e=>{let t=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return(0,i._)([(0,o.MZ)(a)],t.prototype,"blendMode",void 0),(0,i._)([(0,o.MZ)(d)],t.prototype,"effect",void 0),t=(0,i._)([(0,r.$)("esri.layers.mixins.BlendLayer")],t),t}},37534:(e,t,n)=>{n.d(t,{f:()=>d,n:()=>l});var i=n(35143),o=n(48611),r=n(46053),s=(n(81806),n(76460),n(47249),n(85842)),a=n(51162);const l={type:[a.A],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:function(e,t,n){if(!e)return null;const i=e.find((e=>!!e.field));if(!i)return null;const o=new a.A;return o.read(i,n),[o]}},write:{writer:function(e,t,n,i){const r=e.find((e=>!!e.field));r&&(0,o.sM)(n,[r.toJSON()],t)}}}},d=e=>{let t=class extends e{constructor(){super(...arguments),this.orderBy=null}};return(0,i._)([(0,r.MZ)(l)],t.prototype,"orderBy",void 0),t=(0,i._)([(0,s.$)("esri.layers.mixins.OrderedLayer")],t),t}},21617:(e,t,n)=>{n.d(t,{J:()=>w});var i=n(35143),o=(n(81806),n(76460)),r=n(50346),s=n(46053),a=n(21403),l=(n(47249),n(85842)),d=n(80979),u=n(94643),p=(n(98773),n(50076),n(68452),n(49281));const c=new u.A,h=new WeakMap;function y(e){f(e)&&c.push(new WeakRef(e))}function f(e){return null!=e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e}function m(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:m(t,e%t):0}let g=0,v=0;function _(){const e=Date.now();let t=!1;for(const i of c){const o=i.deref();var n;if(o){if(o.refreshInterval)e-(null!==(n=h.get(o))&&void 0!==n?n:0)+5>=6e4*o.refreshInterval&&(h.set(o,e),o.refresh(e))}else t=!0}if(t)for(let i=c.length-1;i>=0;i--)c.at(i).deref()||c.removeAt(i)}(0,p.fm)((()=>{const e=Date.now();let t=0;for(const n of c){const i=n.deref();i&&(t=m(Math.round(6e4*i.refreshInterval),t),i.refreshInterval?h.get(i)||h.set(i,e):h.delete(i))}if(t!==v){if(v=t,clearInterval(g),0===v)return void(g=0);g=setInterval(_,v)}}));const w=e=>{let t=class extends e{constructor(){super(...arguments),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,r.sg)((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||y(this)}),(()=>{}))}destroy(){!function(e){const t=c.find((t=>t.deref()===e));t&&c.remove(t)}(this)}castRefreshInterval(e){return e>=.1?e:e<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();(0,r.QZ)(this._debounceHasDataChanged()).then((t=>{t&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:t})}),(e=>{o.A.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})}))}async hasDataChanged(){return!0}get test(){}};return(0,i._)([(0,s.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:d.K}}}}})],t.prototype,"refreshInterval",void 0),(0,i._)([(0,a.w)("refreshInterval")],t.prototype,"castRefreshInterval",null),(0,i._)([(0,s.MZ)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),(0,i._)([(0,s.MZ)({readOnly:!0})],t.prototype,"refreshParameters",null),t=(0,i._)([(0,l.$)("esri.layers.mixins.RefreshableLayer")],t),t}},51162:(e,t,n)=>{n.d(t,{A:()=>p});var i,o=n(35143),r=n(45802),s=n(42553),a=n(46053),l=(n(81806),n(76460),n(47249),n(85842));const d=new r.J({asc:"ascending",desc:"descending"});let u=i=class extends s.oY{constructor(e){super(e),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new i({field:this.field,valueExpression:this.valueExpression,order:this.order})}};(0,o._)([(0,a.MZ)({type:String,json:{write:!0}})],u.prototype,"field",void 0),(0,o._)([(0,a.MZ)({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],u.prototype,"valueExpression",void 0),(0,o._)([(0,a.MZ)({type:d.apiValues,json:{type:d.jsonValues,read:d.read,write:d.write}})],u.prototype,"order",void 0),u=i=(0,o._)([(0,l.$)("esri.layers.support.OrderByInfo")],u);const p=u},65460:(e,t,n)=>{n.d(t,{BI:()=>m,D3:()=>y,XJ:()=>f,lc:()=>h,mX:()=>v,rU:()=>g,tH:()=>M});var i=n(88685);const o="__begin__",r="__end__",s=new RegExp(o,"ig"),a=new RegExp(r,"ig"),l=new RegExp("^"+o,"i"),d=new RegExp(r+"$","i"),u='"',p=u+" + ",c=" + "+u;function h(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function y(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function f(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=h(e.labelExpression),t.type="conventional"),t}function m(e){const t=f(e);if(!t)return null;switch(t.type){case"conventional":return v(t.expression);case"arcade":return t.expression}return null}function g(e){const t=f(e);if(!t)return null;switch(t.type){case"conventional":return function(e){const t=null===e||void 0===e?void 0:e.match(_);return(null===t||void 0===t?void 0:t[1].trim())||null}(t.expression);case"arcade":return M(t.expression)}return null}function v(e){let t;return e?(t=(0,i.HC)(e,(e=>o+'$feature["'+e+'"]'+r)),t=l.test(t)?t.replace(l,""):u+t,t=d.test(t)?t.replace(d,""):t+u,t=t.replaceAll(s,p).replaceAll(a,c)):t='""',t}const _=/^\s*\{([^}]+)\}\s*$/i;const w=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,b=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,T=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function M(e){if(!e)return null;let t=w.exec(e)||b.exec(e);return t?t[1]||t[3]:(t=T.exec(e),t?t[2]:null)}},9505:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(35143),o=(n(35238),n(46053)),r=(n(81806),n(76460),n(47249),n(85842)),s=n(27544),a=n(19247);let l=class extends s.A{constructor(e){super(e),this.layoutGeometry=null}};(0,i._)([(0,o.MZ)({type:a.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,i._)([(0,r.$)("esri.rest.knowledgeGraph.Entity")],l);const d=l},27544:(e,t,n)=>{n.d(t,{A:()=>l});var i=n(35143),o=n(46053),r=(n(81806),n(76460),n(47249),n(85842)),s=n(12831);let a=class extends s.A{constructor(e){super(e),this.typeName=null,this.id=null}};(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],a.prototype,"typeName",void 0),(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],a.prototype,"id",void 0),a=(0,i._)([(0,r.$)("esri.rest.knowledgeGraph.GraphNamedObject")],a);const l=a},12831:(e,t,n)=>{n.d(t,{A:()=>l});var i=n(35143),o=n(42553),r=n(46053),s=(n(81806),n(76460),n(47249),n(85842));let a=class extends o.oY{constructor(e){super(e),this.properties=null}};(0,i._)([(0,r.MZ)({json:{write:!0}})],a.prototype,"properties",void 0),a=(0,i._)([(0,s.$)("esri.rest.knowledgeGraph.GraphObject")],a);const l=a},35380:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(35143),o=n(46053),r=(n(81806),n(76460),n(47249),n(85842)),s=n(91967);let a=class extends s.A{constructor(e){super(e),this.openCypherQuery=""}};(0,i._)([(0,o.MZ)()],a.prototype,"openCypherQuery",void 0),a=(0,i._)([(0,r.$)("esri.rest.knowledgeGraph.GraphQuery")],a);const l=a;let d=class extends l{constructor(e){super(e),this.bindParameters=null,this.bindGeometryQuantizationParameters=null,this.outputQuantizationParameters=null,this.outputSpatialReference=null,this.provenanceBehavior=null}};(0,i._)([(0,o.MZ)()],d.prototype,"bindParameters",void 0),(0,i._)([(0,o.MZ)()],d.prototype,"bindGeometryQuantizationParameters",void 0),(0,i._)([(0,o.MZ)()],d.prototype,"outputQuantizationParameters",void 0),(0,i._)([(0,o.MZ)()],d.prototype,"outputSpatialReference",void 0),(0,i._)([(0,o.MZ)()],d.prototype,"provenanceBehavior",void 0),d=(0,i._)([(0,r.$)("esri.rest.knowledgeGraph.GraphQueryStreaming")],d);const u=d},38156:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(35143),o=(n(76460),n(81806),n(47249),n(50076),n(85842)),r=n(12831);let s=class extends r.A{constructor(e){super(e)}};s=(0,i._)([(0,o.$)("esri.rest.knowledgeGraph.ObjectValue")],s);const a=s},68325:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(35143),o=n(42553),r=n(46053),s=(n(81806),n(76460),n(47249),n(85842)),a=n(12831);let l=class extends o.oY{constructor(e){super(e),this.path=null}};(0,i._)([(0,r.MZ)({type:[a.A],json:{write:!0}})],l.prototype,"path",void 0),l=(0,i._)([(0,s.$)("esri.rest.knowledgeGraph.Path")],l);const d=l},23908:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(35143),o=(n(35238),n(46053)),r=(n(81806),n(76460),n(47249),n(85842)),s=n(27544),a=n(23701);let l=class extends s.A{constructor(e){super(e),this.originId=null,this.destinationId=null,this.layoutGeometry=null}};(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"originId",void 0),(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"destinationId",void 0),(0,i._)([(0,o.MZ)({type:a.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,i._)([(0,r.$)("esri.rest.knowledgeGraph.Relationship")],l);const d=l},77725:(e,t,n)=>{n.d(t,{A:()=>_});var i,o=n(35143),r=n(35238),s=n(39356),a=n(45802),l=n(42553),d=n(53084),u=n(46053),p=(n(81806),n(76460),n(28379)),c=n(85842),h=n(17707),y=n(13312),f=n(19902),m=n(44135);const g=new a.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let v=i=class extends l.oY{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){const n=y.A.fromJSON(t.spatialReference),i=[];for(let r=0;r<e.length;r++){var o;const t=e[r],a=s.A.fromJSON(t),l=null===(o=t.geometry)||void 0===o?void 0:o.spatialReference;null==a.geometry||l||(a.geometry.spatialReference=n);const d=t.aggregateGeometries,u=a.aggregateGeometries;if(d&&null!=u)for(const e in u){const t=u[e],i=d[e],o=null===i||void 0===i?void 0:i.spatialReference;null==t||o||(t.spatialReference=n)}i.push(a)}return i}writeGeometryType(e,t,n,i){if(e)return void g.write(e,t,n,i);const{features:o}=this;if(o)for(const r of o)if(null!=(null===r||void 0===r?void 0:r.geometry))return void g.write(r.geometry.type,t,n,i)}readQueryGeometry(e,t){if(!e)return null;const n=!!e.spatialReference,i=(0,f.rS)(e);return i&&!n&&t.spatialReference&&(i.spatialReference=y.A.fromJSON(t.spatialReference)),i}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:n}=this;if(n)for(const i of n)if(i&&null!=i.geometry&&i.geometry.spatialReference)return void(t.spatialReference=i.geometry.spatialReference.toJSON())}clone(){return new i(this.cloneProperties())}cloneProperties(){return(0,d.o8)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(e){const t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(let n=0;n<t.features.length;n++){const i=t.features[n];if(i.geometry){const t=null===e||void 0===e?void 0:e[n];i.geometry=(null===t||void 0===t?void 0:t.toJSON())||i.geometry}}return t}quantize(e){const{scale:[t,n],translate:[i,o]}=e,r=this.features,s=this._getQuantizationFunction(this.geometryType,(e=>Math.round((e-i)/t)),(e=>Math.round((o-e)/n)));for(let a=0,l=r.length;a<l;a++)(null===s||void 0===s?void 0:s(r[a].geometry))||(r.splice(a,1),a--,l--);return this.transform=e,this}unquantize(){var e,t;const{geometryType:n,features:i,transform:o}=this;if(!o)return this;const{translate:[r,s],scale:[a,l]}=o;let d=null,u=null;if(this.hasZ&&null!=(null===o||void 0===o||null===(e=o.scale)||void 0===e?void 0:e[2])){const{translate:[,,e],scale:[,,t]}=o;d=n=>n*t+e}if(this.hasM&&null!=(null===o||void 0===o||null===(t=o.scale)||void 0===t?void 0:t[3])){const{translate:[,,,e],scale:[,,,t]}=o;u=n=>null==n?n:n*t+e}const p=this._getHydrationFunction(n,(e=>e*a+r),(e=>s-e*l),d,u);for(const{geometry:c}of i)null!=c&&p&&p(c);return this.transform=null,this}_quantizePoints(e,t,n){let i,o;const r=[];for(let s=0,a=e.length;s<a;s++){const a=e[s];if(s>0){const e=t(a[0]),s=n(a[1]);e===i&&s===o||(r.push([e-i,s-o]),i=e,o=s)}else i=t(a[0]),o=n(a[1]),r.push([i,o])}return r.length>0?r:null}_getQuantizationFunction(e,t,n){return"point"===e?e=>(e.x=t(e.x),e.y=n(e.y),e):"polyline"===e||"polygon"===e?e=>{const i=(0,f.Bi)(e)?e.rings:e.paths,o=[];for(let r=0,s=i.length;r<s;r++){const e=i[r],s=this._quantizePoints(e,t,n);s&&o.push(s)}return o.length>0?((0,f.Bi)(e)?e.rings=o:e.paths=o,e):null}:"multipoint"===e?e=>{const i=this._quantizePoints(e.points,t,n);return i&&i.length>0?(e.points=i,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,n,i,o){return"point"===e?e=>{e.x=t(e.x),e.y=n(e.y),i&&(e.z=i(e.z))}:"polyline"===e||"polygon"===e?e=>{const r=(0,f.Bi)(e)?e.rings:e.paths;let s,a;for(let i=0,o=r.length;i<o;i++){const e=r[i];for(let i=0,o=e.length;i<o;i++){const o=e[i];i>0?(s+=o[0],a+=o[1]):(s=o[0],a=o[1]),o[0]=t(s),o[1]=n(a)}}if(i&&o)for(let t=0,n=r.length;t<n;t++){const e=r[t];for(let t=0,n=e.length;t<n;t++){const n=e[t];n[2]=i(n[2]),n[3]=o(n[3])}}else if(i)for(let t=0,n=r.length;t<n;t++){const e=r[t];for(let t=0,n=e.length;t<n;t++){const n=e[t];n[2]=i(n[2])}}else if(o)for(let t=0,n=r.length;t<n;t++){const e=r[t];for(let t=0,n=e.length;t<n;t++){const n=e[t];n[2]=o(n[2])}}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=n(e.ymin),e.xmax=t(e.xmax),e.ymax=n(e.ymax),i&&null!=e.zmax&&null!=e.zmin&&(e.zmax=i(e.zmax),e.zmin=i(e.zmin)),o&&null!=e.mmax&&null!=e.mmin&&(e.mmax=o(e.mmax),e.mmin=o(e.mmin))}:"multipoint"===e?e=>{const r=e.points;let s,a;for(let i=0,o=r.length;i<o;i++){const e=r[i];i>0?(s+=e[0],a+=e[1]):(s=e[0],a=e[1]),e[0]=t(s),e[1]=n(a)}if(i&&o)for(let t=0,n=r.length;t<n;t++){const e=r[t];e[2]=i(e[2]),e[3]=o(e[3])}else if(i)for(let t=0,n=r.length;t<n;t++){const e=r[t];e[2]=i(e[2])}else if(o)for(let t=0,n=r.length;t<n;t++){const e=r[t];e[2]=o(e[2])}}:null}};(0,o._)([(0,u.MZ)({type:String,json:{write:!0}})],v.prototype,"displayFieldName",void 0),(0,o._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"exceededTransferLimit",void 0),(0,o._)([(0,u.MZ)({type:[s.A],json:{write:!0}})],v.prototype,"features",void 0),(0,o._)([(0,p.w)("features")],v.prototype,"readFeatures",null),(0,o._)([(0,u.MZ)({type:[m.A],json:{write:!0}})],v.prototype,"fields",void 0),(0,o._)([(0,u.MZ)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:g.read}}})],v.prototype,"geometryType",void 0),(0,o._)([(0,h.K)("geometryType")],v.prototype,"writeGeometryType",null),(0,o._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasM",void 0),(0,o._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasZ",void 0),(0,o._)([(0,u.MZ)({types:r.yR,json:{write:!0}})],v.prototype,"queryGeometry",void 0),(0,o._)([(0,p.w)("queryGeometry")],v.prototype,"readQueryGeometry",null),(0,o._)([(0,u.MZ)({type:y.A,json:{write:!0}})],v.prototype,"spatialReference",void 0),(0,o._)([(0,h.K)("spatialReference")],v.prototype,"writeSpatialReference",null),(0,o._)([(0,u.MZ)({json:{write:!0}})],v.prototype,"transform",void 0),v=i=(0,o._)([(0,c.$)("esri.rest.support.FeatureSet")],v),v.prototype.toJSON.isDefaultToJSON=!0;const _=v}}]);
//# sourceMappingURL=1323.35c16810.chunk.js.map